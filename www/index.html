<!DOCTYPE html> 
<html> 

<!--
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
-->

<meta name="viewport" content="width=device-width">
<meta http-equiv="Cache-Control" content="max-age=10" /> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<head>
	<link rel="shortcut icon" href="diamond.ico" />  
	<title>Big Boss 2</title>
	
	<style type="text/css"> 
		
		/*trying something out for responsive web design, as with the meta tag above*/
		@-ms-viewport
		{
		  width: device-width;
		}
		
		body 
		{
			color: #E9E9E9;
			background-color: black;	
			font-family: "My Custom Font", Robota, Tahoma;
			font-size: 15px;
			/*background-image: url("images/black3.png");*/
		}
	
		@font-face {
		font-family: "Abel";
		src: url(font/font_abel.ttf) format("truetype");
		}
		
		div.center
		{
			text-align:center;
			-webkit-border-radius: 0.75em;
			/*-moz-border-radius: 0.75em;*/
			border-radius:0.75em;			
			/*background-color:rgba(33, 33, 33, 0.6);*/
			color:#ffffff;
			padding:25px;
			
			margin: 0;
			position: absolute;
			top: 30%;
			left: 50%;
			transform: translate(-50%, -30%);
	
		}
		
		div.adjustedCenter
		{
			box-sizing: border-box;
			text-align:center;
			-webkit-border-radius: 0.75em;
			/*-moz-border-radius: 0.75em;*/
			border-radius:0.75em;			
			/*background-color:rgba(33, 33, 33, 0.6);*/
			color:#ffffff;
			padding:10px; /*25px*/
		}
		
		.leftText
		{
			text-align:left;
		}
		
		.centerText
		{
			text-align:center;
		}
		
		.disable-doubletap-to-zoom 
		{
			touch-action: manipulation;
		}
		
		.button2 
		{
			color: black;
			background-color: white;
			border: 1px solid white;
			padding: 2px 4px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 18px;
			font-family: 'Abel', sans-serif;
			margin: 4px 2px;
			-webkit-transition-duration: 0.4s; /* Safari */
			transition-duration: 0.4s;
			cursor: pointer;
			height: 40px;
			width: 50px;
			border-radius: 4px;
		}
		
		.button2:hover 
		{
			color: black;
			background-color: orange;			
			border: 1px solid black;
		}
		
		.heading
		{
			color: #FFC300;	
            font-size: 22px;
			font-family: 'Abel', sans-serif;
		}
		.heading2
		{
			color: #FFC300;	
            font-size: 18px;
			font-family: 'Abel', sans-serif;
		}
		.adviceSubtitle
		{
			display:block;
			width:640px;
			word-wrap:break-word;
		}
		
		.deckOutput
		{
			color: yellow;
			position:absolute;
			top:0px;
			left:1800px;
			z-index:5;
			font-size: 12px;
		}
	
		.playerComplaints
		{
			color: white;
			position:absolute;
			top:750px;
			left:20px;
			z-index:5;
			display: none;
		}
		
		.nextStageButton
		{
			position:absolute;
			top:365px;
			left:280px;
			z-index:5;
			width: 300px;
		}
		
		.passButton
		{
			position:absolute;
			top: 365px;
			left: 170px; 
			z-index:5;
			width:200px;
		}
		
		.playHandButton
		{
			position:absolute;
			top: 365px;
			left: 430px;
			width:200px;
			z-index:5;
		}
	
		.primaryCanvas 
		{
			box-sizing: border-box;
			
			background:#0e8e39;/*#000;*/
			position:absolute;
			top:10px; /*10px*/
			left: 10px; /*10px*/
			border: 0px solid rgba(0,255,0,.2);
			border-radius: 12px;
			z-index:3;
			background-image: radial-gradient(limegreen, darkgreen); /*weird gradient bg*/
		}
		
		.devExtras
		{
			position: absolute;
			left:10px;
			top:620px;
			display: none;
		}
		.LoDText
		{
			display:block;
			width:750px;
			word-wrap:break-word;
		}
		
		.returnToTitle 
		{
			position:absolute;
			/*top:10px; 
			left: 10px;*/ 
			z-index:10;
			display:none;
			
			margin: 0;
			position: absolute;
			top: 2%;
			left: 50%;
			transform: translate(-50%, -2%);
			
			color: black;
			background-color: white;
			border: 1px solid black;
			padding: 2px 4px;
			text-align: center;
			text-decoration: none;
			font-size: 22px;
			font-family: 'Abel', sans-serif;
			margin: 4px 2px;
			-webkit-transition-duration: 0.4s; /* Safari */
			transition-duration: 0.4s;
			cursor: pointer;
			height: 60px;
			width: 100px;
			border-radius: 20px; /*4*/
			
			
		}
		.returnToTitle:hover 
		{
			color: black;
			background-color: LimeGreen;			
			border: 1px solid black;
		}
		
		.animationCanvas 
		{
			box-sizing: border-box;
			position:absolute;
			top:10px; /*10px*/
			left: 10px; /*10px*/
			z-index:9;
			display:none;
			/*width: 95%;
			height: 95%;*/
		}
		
		
		.devCanvas 
		{
			background:seagreen;/*#0e8e39;*/
			position:absolute;
			top:10px;
			left: 940px; 
			border: 2px solid rgba(0,255,0,.2);
			z-index:3;
			display:none;
		}
		
		.imageOutline
		{
			
			-webkit-user-select: none;
			-khtml-user-select: none;
			-moz-user-select: none;
			-o-user-select: none;
			user-select: none;
			
			-webkit-user-drag: none;
			-khtml-user-drag: none;
			-moz-user-drag: none;
			-o-user-drag: none;
			user-drag: none;
			
			box-sizing: border-box; 
			border: 1px solid rgba(0,0,0,1);
			/*border-radius: 8px;*/
						
		}
		
		.orangeBox
		{
			box-sizing: border-box; /*Include padding and border in the element's total width and height:*/
			position: absolute;
			z-index:9;
			background:#232323; /*#232323;*/
			border: 0px solid orange; /*2px solid orange;*/
			display: none; /*this one might be iffy*/
			/*background-image: url("images/blackBG.jpg");*/
		}
				
		.characterScreen
		{
			height:480px;
			width:600px;
		}
				
		.extraStats
		{
			position: absolute;
			z-index:9;
			background:black;/*#232323;*/
			border: 0px solid orange;
			display: none;
			height:800px;
			
		}
		.statCanvas 
		{
			background:#232323;/*#000;*/
			border-radius: 12px;
			border: 1px solid rgba(0,0,255,.1);
			z-index:3;
		}
		
		.mainScreen
		{
			box-sizing: border-box;
			display: none;
		}
		
		#playerStats
		{
			position: absolute;
			top:20px;
			left:1500px;
			z-index:9;
		}
		
		
		
		/*mobile elements*/
		.mobileScreen
		{
			box-sizing: border-box;
			display:block;
			border: 0px solid green;
			padding:0px;
			display: none;
		}
		
		.mobileCanvas 
		{
			box-sizing: border-box;
			
			background:#0e8e39;/*#000;*/
			position:absolute;
			top:5px; /*10px*/
			left: 5px; /*10px*/
			/*border: 2px solid rgba(255,215,10,1);*/
			border-radius: 12px;
			border: 0px solid rgba(0,255,0,.5);
			z-index:3;
			background-image: radial-gradient(limegreen, darkgreen); /*weird gradient bg*/
		}
		
		.mobileNext
		{
			position:absolute;
			top: 630px;
			left:150px;
			z-index:5;
			width: 270px; /*300*/
			height: 75px;
		}
		
		.mobilePass
		{
			position:absolute;
			top: 620px;
			left: 40px;
			z-index:5;
			width: 150px;
			height: 75px;
		}
		
		.mobilePlay
		{
			position:absolute;
			top: 620px;
			left: 400px;
			width: 150px;
			height: 75px;
			z-index:5;
		}
				
	
	</style>

</head>

<body onload="hello();">
	
	<div class="mobileScreen disable-doubletap-to-zoom" id="mobileScreen">
		<canvas id="mobileCanvas" class="mobileCanvas disable-doubletap-to-zoom" onclick="canvasClick(event)"></canvas>
		<input id="mobilePass" class = "mobilePass button2 disable-doubletap-to-zoom" type ="button" value ="PASS" onclick="passButton();"> 
		<input id="mobilePlay" class = "mobilePlay button2 disable-doubletap-to-zoom" type ="button" value ="PLAY" onclick="playPlayerHand();"> 
		<input id="mobileNext" class = "mobileNext button2 disable-doubletap-to-zoom" type ="button" value ="OKAY" onclick="nextStageButton();">
	</div>
	
	<div class="mainScreen" id="mainScreen">
		<input id="magicButton" type ="button" value ="MAGIC" onclick="magicButton();">  
		<input id="passButton" class = "passButton button2" type ="button" value ="PASS" onclick="passButton();"> 
		<input id="playHandButton" class = "playHandButton button2" type ="button" value ="PLAY" onclick="playPlayerHand();"> 
		<input id="nextStageButton" class = "nextStageButton button2" type ="button" value ="OKAY" onclick="nextStageButton();"> 
		<div class="deckOutput" id="deckOutput">
		</div>
		
		<div class ="playerStats" id ="playerStats"></div>
		
		<div class ="playerComplaints" id ="playerComplaints"></div>
						
		<canvas id="primaryCanvas" class="primaryCanvas" onmousemove="canvasMove(event)" onclick="canvasClick(event)"></canvas>
		<canvas id="devCanvas" class="devCanvas" onclick="canvasClick(event)"></canvas>
	</div>
	
	
	<div class="devExtras" id="devExtras">
		<!--
		<input id="LoD1" type ="button" value ="Play Order" onclick="LifeOrDeath(1);">  
		-->
		<input id="LoD2" type ="button" value ="Dueling" onclick="LifeOrDeath('duel');"> 
		<input id="LoD2" type ="button" value ="Breaking Doubles" onclick="LifeOrDeath('doubleSplit');"> 
		<input id="LoD2" type ="button" value ="Playing To Win (Single Card)" onclick="LifeOrDeath('highplay');"> 
		<input id="LoD2" type ="button" value ="Playing To Win (Doubles)" onclick="LifeOrDeath('doubleHighplay');"> 
		<input id="LoD2" type ="button" value ="Opening Strategy" onclick="LifeOrDeath('openrank');"> 
		<input id="LoD2" type ="button" value ="Card Analysis" onclick="LifeOrDeath('cardanalysis');"> 
		<input id="LoD2" type ="button" value ="Conservatism" onclick="LifeOrDeath('conservative');"> 
		</br/>
		<input id="LoD2" type ="button" value ="Single Hand" onclick="LifeOrDeath('single');">
		<input id="LoD2" type ="button" value ="Double Guess" onclick="LifeOrDeath('doubleguess');">
				
		<br />
		<br />
		<span class = "LoDText" id="LoDText">Life or deeeeaaaattthh! Click one of the buttons above to choose a scenario that showcases some of the AI's personality quirks.</span>
	</div>
	
	
	
	<div id="menuScreen" class="orangeBox adjustedCenter"> <!-- center-->
		<span class="heading">WELCOME TO BIG BOSS 2</span>
		
		<br/>
		<br/>							<!--540-->
		<img class="imageOutline" id="menuImg" src="images/douchebag3.png">
		<br/>
		<br/>
		<span class="heading2">One in four people are a Big Boss. Are you, too?</span>
		</br>
		</br>
		<input class = "button2" style="width:400px;" type ="button" value ="PLAY BIG BOSS 2" onclick="showIntroScreen()"> 
		<br/>
		<input class = "button2" style="width:400px;" type ="button" value ="WAIT, HOW DO I PLAY!??" onclick="showRuleScreen()"> 
		<br/>
		<input class = "button2" style="width:400px;" type ="button" value ="SHOW ME THE STATS" onclick="showStatScreen()"> 
	
	</div>
	
	<div id="introScreen" class="orangeBox adjustedCenter"> <!-- center-->
		<span class="heading">A CHALLENGE IS MADE</span>
		<br/>
		<span class="heading2">So you think you have what it takes to defeat our greatest champions?</span>
		<br/>
		<br/>							<!--540-->
		<img class="imageOutline" id="introImg" width="450px" src="images/bigbosspanel.png">
		<br/>
		<br/>
		<input class = "button2" style="width:400px;" type ="button" value ="I FEAR NO BOSS!" onclick="showCharSelect()">  
	</div>
	
	<div id="characterScreen" class="orangeBox characterScreen adjustedCenter"> <!-- center-->
		<span class="heading">SELECT AN EMPLOYEE</span>
		<br/>
		<span class="heading2">Choose an avatar to represent you in the boardroom.</span>
		<br/>
		<br/>
		<img id="character0" class="imageOutline" onclick="reselectPlayer(0);" onmouseout="deselectPlayer(0);" onmouseover="selectPlayer(0);" src="">
		<img id="character1" class="imageOutline" onclick="reselectPlayer(1);" onmouseout="deselectPlayer(1);" onmouseover="selectPlayer(1);" src="">
		<img id="character2" class="imageOutline" onclick="reselectPlayer(2);" onmouseout="deselectPlayer(2);" onmouseover="selectPlayer(2);" src="">
		<img id="character3" class="imageOutline" onclick="reselectPlayer(3);" onmouseout="deselectPlayer(3);" onmouseover="selectPlayer(3);" src="">
		<br/>
		<img id="character4" class="imageOutline" onclick="reselectPlayer(4);" onmouseout="deselectPlayer(4);" onmouseover="selectPlayer(4);" src="">
		<img id="character5" class="imageOutline" onclick="reselectPlayer(5);" onmouseout="deselectPlayer(5);" onmouseover="selectPlayer(5);" src="">
		<img id="character6" class="imageOutline" onclick="reselectPlayer(6);" onmouseout="deselectPlayer(6);" onmouseover="selectPlayer(6);" src="">
		<img id="character7" class="imageOutline" onclick="reselectPlayer(7);" onmouseout="deselectPlayer(7);" onmouseover="selectPlayer(7);" src="">
		
		
		<br/>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="YES, YOU WILL BE MY CHAMPION..." onclick="startGame(playerID);">
		<br/>
		<br/>
		
		<span id="characterSummary" class="heading2">...</span>
		
	</div>
	
	
	<canvas id="animationCanvas" class="animationCanvas" onmousemove="canvasMove(event)" onclick="canvasClick(event)"></canvas>
	<input id="returnToTitle" class = "returnToTitle" style="width:400px;" type ="button" value ="RETURN TO TITLE" onclick="returnToTitle();"> 
		
	
	<div id="winScreen" class="orangeBox adjustedCenter"> <!-- center-->
		
		<span class="heading">WINNER, WINNER, CHICKEN DINNER!</span>
		<br/>
		<span class="heading2">Wow! You defeated our greatest bosses and actually won!</span>
		<br/>
		<br/>
		<img class="imageOutline" id="winnerImg" src="images/winner.png">
		<br/>
		<br/>
		<span id="winAdvice" class="heading2 adviceSubtitle">People say the tallest nail is the first to get hammered down, but what do they know?</span>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="I WILL BE THE BIGGEST BOSS!" onclick="showExtraStats();"> 
	</div>
	
	<div id="okayScreen" class="orangeBox adjustedCenter"> <!-- center-->
		<span class="heading">NOT BAD, CHAMP!</span>
		<br/>
		<span class="heading2">You got rid of all your cards! But most importantly - you didn't lose! </span>
		<br/>
		<br/>
		<img class="imageOutline" id="okayImg" src="images/lameParty1.png">
		<br/>
		<br/>
		<span id="okayAdvice" class="heading2 adviceSubtitle">The important thing to remember here is that you *participated*.</span>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="'MEDICORE' IS THE NEW 'FABULOUS'" onclick="showExtraStats();"> 
	</div>
	
	<div id="loseScreen" class="orangeBox adjustedCenter"> <!-- center-->
		<span class="heading">YOU LOSE!</span>
		<br/>
		<span class="heading2">Uh-oh! Looks like you lost. I guess it's a handful of DELICIOUS FISH for you!</span>
		<br/>
		<br/>
		<img class="imageOutline" id="loserImg" src="images/deliciousfish.png">
		<br/>
		<br/>
		<span id="loseAdvice" class="heading2 adviceSubtitle">The important thing to remember here is that you *participated*.</span>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="OH GOD, WHY?" onclick="showExtraStats();"> 
	</div>
		
		
	
	
	
	<div id="superwinScreen" class="orangeBox adjustedCenter"> <!-- center-->
		
		<span class="heading">LOOKS LIKE THERE'S A NEW BOSS IN TOWN!</span>
		<br/>
		<span class="heading2">Once you lead this company, you *never* leave.</span>
		<br/>
		<br/>
		<img class="imageOutline" src="images/superwin.jpg">
		<br/>
		<br/>
		<span id="superwinAdvice" class="heading2 adviceSubtitle"></span>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="I AM THE BIGGEST BOSS!" onclick="showCardBounce();"> 
	</div>
	
	<div id="superokayScreen" class="orangeBox adjustedCenter"> <!-- center-->
		<span class="heading">CAN YOU COME IN ON SATURDAY?</span>
		<br/>
		<span class="heading2">While you may not be Big Boss™ material, we think you're a fantastic s̶l̶a̶v̶e  employee!</span>
		<br/>
		<br/>
		<img class="imageOutline" src="images/superokay.jpg">
		<br/>
		<br/>
		<span id="superokayAdvice" class="heading2 adviceSubtitle"></span>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="I WILL WORK HARDER..." onclick="returnToTitle();"> 
	</div>
	
	<div id="superloseScreen" class="orangeBox adjustedCenter"> <!-- center-->
		<span class="heading">WELL, NOT EVERYONE IS A LEADER...</span>
		<br/>
		<span class="heading2">It's not the destination that matters, it's the journey... right??</span>
		<br/>
		<br/>
		<img class="imageOutline" src="images/superfail.jpg">
		<br/>
		<br/>
		<span id="superloseAdvice" class="heading2 adviceSubtitle"></span>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="IT'S GAME OVER, MAN. IT'S GAME OVER!" onclick="returnToTitle();"> 
	</div>
	
	
	
	
	
	
	
		
		
	<div id="extraStats" class="adjustedCenter extraStats"> <!-- center-->
		<span class="heading">PLAYER LEADERBOARD</span>
		<br />
		<span class="heading2">The first player to 30 points wins!</span>
		<br/>
		<br/>
		<canvas id="statCanvas" class="statCanvas"></canvas>
		<br/>
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="COOL STORY, BRO." onclick="restart(playerID);"> 
	</div>
	
	
	<div id="ruleScreen" class="orangeBox adjustedCenter"> <!-- center-->
		
		<span class="heading">HOW TO PLAY</span>
		<br/>
		<br/>
		<span style="color:orange">Big Boss 2</span> is a card discarding game with a few simple rules.</br>
			
		<div class="centerText">
			</br>
			<span class="centerText" style="color:DarkOrange ">WINNING AND LOSING</span>
			<ul class="leftText">
				<li>The first player to lose all their cards wins the game.</li>
				<li>The last player to lose all their cards loses the game.</li>
			</ul>
			
			<span style="color:DarkOrange ">CARD VALUE</span>
			<ul class="leftText">
				<li>The cards are ranked in ascending order, but 2 is the highest card.</li>
				<li>3 < 4 < 5 < 6 < 7 < 8 < 9 < 10 < J < Q < K < A < 2</li>
				<li>In the case of equal value cards, suits are ranked alphabetically.</li>
				<li> Clubs < Diamonds < Hearts < Spades </li>
			</ul>
			
			<span style="color:DarkOrange ">VALID HANDS</span> <br/><br/>
			<span>There are four standard hands that can be played.</span>
			<ul class="leftText">
				<li>A single card (e.g: 3)</li>
				<li>A pair (e.g: 3,3)</li> 
				<li>A full house composed of a triple and a pair (e.g: 3,3,3,5,5)</li>
				<li>A five card straight (e.g: 3,4,5,6,7)</li>
			</ul>
			
			<span style="color:DarkOrange ">THE GOLDEN RULE</span> <br/><br/>
			<span>You have to play a higher version of the hand that is on the table.</span>
			<ul class="leftText">
				<li>If a single 3 is on the table, you could play: 4 (or higher)</li>
				<li>If a pair of 3s is on the table, you could play: 44 (or higher)</li> 
				<li>If a full house (e.g: 33355) is on the table, you could play 444455.</li>
				<li>To play a higher full house you must beat the triple.</li>
				<li>If a five card straight (e.g: 34567) is on the table, you could play 56789</li>
				<li>To play a higher straight, you must beat the lowest card in the straight.</li>
			</ul>
			
			<span style="color:DarkOrange ">EXCEPTIONAL HANDS</span>
			<ul class="leftText">
				<span>There are two exceptional hands that can be played at any time.</span>
				<br/><br/>
				<li>A straight flush (e.g: 3,4,5,6,7 [all of hearts])</li>
				<li>A four of a kind with one extra card (e.g: 3,3,3,3,5)</li>
			</ul>
			
			<span style="color:DarkOrange ">PLAY ORDER</span>
			<ul class="leftText">
				<li>The player with the 3 of Clubs plays the first hand.</li>
				<li>The opening hand must include the 3 of Clubs.</li>
				<li>Each successive player must play a higher hand than the last.</li>
				<li>If you are unable or unwilling to play a higher hand, you must pass.</li>
				<li>If you pass voluntarily, you may continue playing later the same round.</li>
								
				<li>Play continues until all players are unable or unwilling to play.</li>
				<li>The last player to have made a valid play "wins" the round.</li>
				<li>After winning a round, the table is "cleared".</li>
				<li>The winner of the previous round can now play any valid hand.</li>
			</ul>
						
		</div>
		<span style="color:orange">That's it!</span> Enjoy playing BB2!</br>
		
		<br/>
		<input id="restart" class = "button2" style="width:400px;" type ="button" value ="OKAY, OKAY, I GOT IT." onclick="returnToTitle()"> 
	</div>
	
	<div  id="statScreen" class="orangeBox adjustedCenter">
		
		<span>Look at these fine warriors!</span>
		<br />
		<br />
		
		<table class="leftText">
		
		
		<tr>
			<td>		
				<img id="pStat_death1"> <br /> 
			</td>
			<td>
				<span id="pStat_name1"></span> <br />
				<span id="pStat_class1"></span> <br />
				<span id="pStat_score1"></span> <br />
				<span id="pStat_deathText1"></span> <br />
				<br />
			</td>
			<td>		
				<img id="pStat_death2"> <br /> 
			</td>
			<td>
				<span id="pStat_name2"></span> <br />
				<span id="pStat_class2"></span> <br />
				<span id="pStat_score2"></span> <br />
				<span id="pStat_deathText2"></span> <br />
				<br />
			</td>
		</tr>
		
			<tr>
			<td>		
				<img id="pStat_death3"> <br /> 
			</td>
			<td>
				<span id="pStat_name3"></span> <br />
				<span id="pStat_class3"></span> <br />
				<span id="pStat_score3"></span> <br />
				<span id="pStat_deathText3"></span> <br />
				<br />
			</td>
			<td>		
				<img id="pStat_death4"> <br /> 
			</td>
			<td>
				<span id="pStat_name4"></span> <br />
				<span id="pStat_class4"></span> <br />
				<span id="pStat_score4"></span> <br />
				<span id="pStat_deathText4"></span> <br />
				<br />
			</td>
		</tr>
		
			<tr>
			<td>		
				<img id="pStat_death5"> <br /> 
			</td>
			<td>
				<span id="pStat_name5"></span> <br />
				<span id="pStat_class5"></span> <br />
				<span id="pStat_score5"></span> <br />
				<span id="pStat_deathText5"></span> <br />
				<br />
			</td>
			<td>		
				<img id="pStat_death6"> <br /> 
			</td>
			<td>
				<span id="pStat_name6"></span> <br />
				<span id="pStat_class6"></span> <br />
				<span id="pStat_score6"></span> <br />
				<span id="pStat_deathText6"></span> <br />
				<br />
			</td>
		</tr>
		
			<tr>
			<td>		
				<img id="pStat_death7"> <br /> 
			</td>
			<td>
				<span id="pStat_name7"></span> <br />
				<span id="pStat_class7"></span> <br />
				<span id="pStat_score7"></span> <br />
				<span id="pStat_deathText7"></span> <br />
				<br />
			</td>
			<td>		
				<img id="pStat_death8"> <br /> 
			</td>
			<td>
				<span id="pStat_name8"></span> <br />
				<span id="pStat_class8"></span> <br />
				<span id="pStat_score8"></span> <br />
				<span id="pStat_deathText8"></span> <br />
				<br />
			</td>
		</tr>
	
		</table>
				
		<input class = "button2" style="width:400px;" type ="button" value ="I COULD EAT THESE GUYS FOR BREAKFAST" onclick="returnToTitle()"> 
	
		
	</div>
	
<script>
	
	
	
function loadData() 
{
    str = "1234";
	
	statNames = [];
	statWins = [];
	statGames = [];
	statLosses = [];
	
	if (str.length == 0) {
        document.getElementById("txtHint").innerHTML = "";
        return;
    } else {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() 
		{
            if (this.readyState == 4 && this.status == 200) 
			{
                
				//document.getElementById("txtHint").innerHTML = this.responseText;
				
				var myObj = JSON.parse(this.responseText);
				//alert(myObj.length);
				var newCounter = 0;
				var x = 1;
				k = "";
				for (var i = 0; i < myObj.length; i++)
				{
					newCounter = newCounter +1;
					k = k + myObj[i] + "<br />";
					
					//extract name and draw player picture
					if(newCounter==1)
					{
						document.getElementById("pStat_name" + x).innerHTML = myObj[i];
						statNames[x-1] = myObj[i];
						
						/*
						if(myObj[i]=="John")
							document.getElementById("pStat_death" + x).src = pDefaultImg[0].src
						else if(myObj[i]=="Jovan")
							document.getElementById("pStat_death" + x).src = pDefaultImg[1].src
						else if(myObj[i]=="Thomas")
							document.getElementById("pStat_death" + x).src = pDefaultImg[2].src
						else if(myObj[i]=="Rafe")
							document.getElementById("pStat_death" + x).src = pDefaultImg[3].src
						else if(myObj[i]=="Joe")
							document.getElementById("pStat_death" + x).src = pDefaultImg[4].src
						else if(myObj[i]=="Mike")
							document.getElementById("pStat_death" + x).src = pDefaultImg[5].src
						else if(myObj[i]=="Julian")
							document.getElementById("pStat_death" + x).src = pDefaultImg[6].src
						else if(myObj[i]=="Maitland")
							document.getElementById("pStat_death" + x).src = pDefaultImg[7].src;
					*/
						if(myObj[i]=="John")
							document.getElementById("pStat_death" + x).src = "images/newplayers/john3.png"
						else if(myObj[i]=="Jovan")
							document.getElementById("pStat_death" + x).src = "images/newplayers/jovan.png"
						else if(myObj[i]=="Thomas")
							document.getElementById("pStat_death" + x).src = "images/newplayers/thomas.png";
						else if(myObj[i]=="Rafe")
							document.getElementById("pStat_death" + x).src = "images/newplayers/rafe2.png"
						else if(myObj[i]=="Joe")
							document.getElementById("pStat_death" + x).src = "images/newplayers/joe.png"
						else if(myObj[i]=="Mike")
							document.getElementById("pStat_death" + x).src = "images/newplayers/mike.png"
						else if(myObj[i]=="Julian")
							document.getElementById("pStat_death" + x).src = "images/newplayers/julian.png"
						else if(myObj[i]=="Maitland")
							document.getElementById("pStat_death" + x).src = "images/newplayers/maitland.png";

						
					}
					else if(newCounter==2)
					{
						document.getElementById("pStat_class" + x).innerHTML = "Games: " +myObj[i];
						statGames[x-1] = myObj[i];
						var tempTotalGames = myObj[i];
						//document.getElementById("pStat_class" + x).innerHTML = myObj[i];
						/*
						if(myObj[i] == "Pyro")
							document.getElementById("pStat_class" + x).style.color = "red"
						else if(myObj[i] == "Mystic")
							document.getElementById("pStat_class" + x).style.color = "blueviolet"
						else if(myObj[i] == "Infiltrator")
							document.getElementById("pStat_class" + x).style.color = "lime"
						else if(myObj[i] == "Trader")
							document.getElementById("pStat_class" + x).style.color = "darkorange"
						else if(myObj[i] == "Avatar")
							document.getElementById("pStat_class" + x).style.color = "aqua"
						else if(myObj[i] == "Cursed Fool")
							document.getElementById("pStat_class" + x).style.color = "silver";
						*/
					}
					else if(newCounter==3)
					{
						//document.getElementById("pStat_score" + x).innerHTML = "Games Won:" + myObj[i];
						statWins[x-1] = myObj[i];
						
						var tempGamesWon = myObj[i];
						var a = tempGamesWon/tempTotalGames*100;
						a = +a.toFixed(2);
						document.getElementById("pStat_score" + x).innerHTML = "Wins: " + a + "%";
					
						
						//var b = tempGamesLost[i]/tempTotalGames*100;
						//b = +b.toFixed(2);
												
					
					
					}
					else if(newCounter==4)
					{
						
						//document.getElementById("pStat_deathText" + x).innerHTML = "Games Lost:" + myObj[i];
						statLosses[x-1] = myObj[i];
						var tempGamesLost = myObj[i];
						var a = tempGamesLost/tempTotalGames*100;
						a = +a.toFixed(2);
						document.getElementById("pStat_deathText" + x).innerHTML = "Losses: " + a + "%";
					
						//if(myObj[i]=="Killed by a motherfucking hidden spike trap")
						//	document.getElementById("pStat_death" + x).src = trapImg.src
						//else if(myObj[i]=="killed by a nefarious spider")
						//	document.getElementById("pStat_death" + x).src = spiderImg.src
						//else if(myObj[i]=="killed by a cantankerous slime")
						//	document.getElementById("pStat_death" + x).src = sludgeImg.src
						//else if(myObj[i]=="killed by a fierce bat")
						//	document.getElementById("pStat_death" + x).src = batImg.src
						//else if(myObj[i]=="killed by a savage explosion")
						//	document.getElementById("pStat_death" + x).src = explosionImg.src;
						
						newCounter = 0;
						x = x + 1;
					}
					
					
				}
				//document.getElementById("txtHint").innerHTML = k;
				
				
            }
        };
        xmlhttp.open("GET", "loadScore.php?q=" + str, true);
        xmlhttp.send();
    }
}

function playerFinish(p)
{
	//loadData();
	//alert("player finish " +p);
	humanState = p;
	testMode = true;
	//alert(statNames.length);
	//for(var i = 0; i < statNames.length; i++)
	//{
	//	alert(statNames[i]);
	//}
	//alert("names finished");
	if(onlineMode)
	{
	
		var arrayIndex = 0;
		
		for(var i = 0; i < statNames.length; i++)
		{
			if(statNames[i]==playerNames[currentPlayer])
			{
				arrayIndex = i;
			}
		}
		
		statGames[arrayIndex]++;
		if(p=="lose")
		{
			statLosses[arrayIndex]++;
		}
		else if(p=="win")
		{
			statWins[arrayIndex]++;
		}
		
		dataArray = [];
		dataCounter = 0;
		
		for(var i = 0; i < statNames.length; i++)
		{
			dataArray[dataCounter] = statNames[i];
			dataCounter++;
			dataArray[dataCounter] = statGames[i];	
			dataCounter++;
			dataArray[dataCounter] = statWins[i];
			dataCounter++;
			dataArray[dataCounter] = statLosses[i];	
			dataCounter++;
		}
		
		//alert(dataArray.length);
		//var k = "";
		//for(var i = 0; i < dataArray.length; i++)
		//{
		//	alert(dataArray[i]);
		//}
		
		saveData();
	}
	
}

function saveData()
{
	
	{
		bob = [];
	
		
		bob = [
		"Mike",
		5,
		4,
		3,
		"Jovan",
		5,
		2,
		2,
		"Joe",
		5,
		3,
		1,
		"John",
		10,
		9,
		1,
		"Rafe",
		5,
		3,
		2,
		"Maitland",
		5,
		0,
		0,
		"Mike",
		5,
		1,
		4,
		"Julian",
		5,
		0,
		0
		];
		
		
		//dbParam = JSON.stringify(bob);
		dbParam = JSON.stringify(dataArray);
		
		var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() 
		{
            if (this.readyState == 4 && this.status == 200) 
			{
                //document.getElementById("txtHint").innerHTML = this.responseText;
				var tempText = this.responseText;
            }
        };
       	xmlhttp.open("GET", "saveScore.php?q=" + dbParam, true);
        xmlhttp.send();
	}
	//else
	//{
		//document.getElementById("txtHint").innerHTML = "You have no heroes. Please play a game of fracture, first";
	//}
	
	
	
}

	//////////////
	//TODO and IDEAS
	//////////////
	
	//food for thought: if there are 2 players left, the other player should 
	//know exactly what cards the other player has because we now have perfect information
	//what cards have been played and what I have.
	//can we use THAT, and comparing our hand to the other player's hand 
	//to somehow be a more effective duelist
	
	
	
	//think more about guaranteed wins relative to the remainder of our hand, and also this in relation 
	// to voluntary passing 
	
	//think about breaking straights/full houses, as straights are pretty strong 
	
	//should we break straights when we have doubles???
	//334567 = 1 round straight and 1 single round (2 rounds) vs 1 double round and 4 single rounds (5 rounds)
	//3344567 = 1 round straight and 2 single rounds (3 rounds) vs 2 double rounds and 3 single rounds (5 rounds)
	//33445567 = 1 round straight and 3 single rounds (4 rounds) vs 3 double rounds and 2 single rounds (5 rounds)
	//334455667 = 1 round straight and 4 single rounds (5 rounds) vs 4 double rounds and 1 single round (5 rounds)
	
	//think about this scenario:
	//computer has 
	//56789 and 2 of spades. table is a 4 of clubs
	//he will try lead with 5 and break his straight, when he could just instantly win
	
	//he should also may try screw over the player if the player only has 1 or 2 cards left by playing higher could by his highest card
	//or perhaps just higher than the player's lowest card lol.
	
	
	//add a deal / complain phase 
	//add alternative character set?
	
	//add four of a kind/straight flushes for AI:
	//four of a kinds probably will generate problems as the single card can be on either side 
	//and probably don't even include a 5th card yet
	//in the ruleset for player hand (and possibly AI hands) we will need some kind of 
	//checkForExceptionalHand thing, to break the tablehand checks
			
	//stats: also keep track of number of singles,doubles,straights,and full houses played by each player 
		
	//big bugs:
	//bugs: not all straights are found: improve straight detection 
	//AI plays straights on straight flushes 
	
	//fuuuuuuuuck are the stats arent even accurate ????
	//can easily see this when testing as a human 
	
	//AI BUGS
	//if he has double ace or double 2 left as his final play 
	//he won't play both, but will try do them one at a time due
	//to trying to conserve doubles
	//to resolve this in single rounds we should check if we have no singles
	//in this case, also check if we have 2 cards remaining
	//if one of our cards is the "highest card" then play it.
	
	//the agreeable AI might still have an issue where he CAN win 
	//by beating the player before him (because he only has 1 or 2 cards left
	//but because he is being "agreeable" chooses not to.
	//try special case this circumstance
	
	
	//more messages (custom message for 2s, specific player, etc.)
	//this hand is so aggressively average it needs a muzzle to go out in public
	
	
	//extra hands to be done
	//four of a kind [hopefully implemented from player side, not yet for AI]
	//straight flush [hopefully implemented from player side, not yet for AI]
	//"real" straight (2,3,4,5,6)
	
	///////////////////
	//WORK KOMPLETE
	///////////////////
	//standarized styling for images and added a border to them
	//added textured background to windows and removed borders
	//removed some redundant code and old, unused elements. 
	//let the player return to title from score and rules screen instead of pushing on
	//fixed a bug with bouncing card screen
	//disabled double clicking causing annoying zoom on mobile [good or bad??]
	//fixed a bug where spamming pass caused issues with animations 
	//added help plaque (much graphix, very wow)
	//added some variation and visibility to the bouncing card scene
	//added 3 new "super" finishing screens 
	//added round points! 30 to win!
	//AI now knows basic dueling
	//added taunts when the first AI player wins
	//standardempty table now uses some instant win hands
	//got rid of annoying alert messages and replaced them with improved canvas text
	//fixed a bug where AI wouldn't open with full house using 3 clubs
	//fixed a bug where AI got stuck with doubles
	//AI considers some instant win scenarios
	//[done]add basic stats for human players  
	//[done]improve doubleSaver AI 
	//[done]add animation for cards
	//[done]new background image
	//[experimentally done] add sound 
	//[done] add better border/divider effects 
	//[done] remove overly obnoxious self referendums
	//[done]add autodetect for mobile or pc version
	//[done]add a "how to play" page
	//[done]make player selection thingy for mobile
	//[done]have some greyed out areas or bigger highlighting/border to indicate the player when they can play
	//[done]maybe bigger cards/buttons for the player 
	//[done]an interim win win whhen you lose your cards 
	//[done]get rid of the alert messages and do something else
	//[done]playing by default seems to work in the wrong direction
	//[donne][potentially fixed] extra steps in the everyone passes thing
	//[fixed?] bugs: when all players pass on your hand the comment is left over??
	//[fixed?] straight power is from the top card not the bottom
	//[fixed?]sometimes doubles (and fullhouses, and maybe other stuff) don't progress next turn somehow
	//[done]highlight cards as you mouse over them
	//[done]some kind of player selection and randomization
	
	///////////////
	//AI PERSONALITIES, ETC
	//////////////////
	
	//SOME AI IDEAS
	
	//Captain Burnout: Always plays if he can, tries to win every round
	//Captain Hangback: Inclined to pass until he knows he can win a round, and then tries to play a straight etc.
	//Captain Doubles: If he has a certain number of unique doubles (say 4), he prioritizes those and doesn't try to make any straights etc.
	
	//complain about: godhand, useless hand, if I lose with this hand, lack of straight, cards over 10
	//having no 2s, straights, full houses 
	//heart of the cards, playing significantly higher than previous player 
	//playing low, etc. 
	
	//strategy should also be based on how many "low cards" the player needs to get rid of 
		
	
	winAdvice = [
				"People say the tallest nail is the first to get hammered down, but what do they know?",
				"At the front of the pack you'll never even *see* all the knives gleaming behind your back.",
				"Now that you've reached the peak, there's nowhere to go but down!",
				"Some people dream of success, while others live to crush those dreams... you monster.",
				"I wonder what happened to the first big boss...",
				"I mean, I guess everybody gets lucky sometimes."
				];
				
	okayAdvice = 	[
					"The important thing to remember is that you *participated*.",
					"Think of it this way: the winner of the race had no one to look up to, whereas you have a LOT of role models! Isn't that great?",
					"The predator attacks the young or the sick; the hunter shoots the largest and the strongest. Really, the middle of the pack is the safest place to be.",
					"You're clearly not shackled to 'traditional' measures of success, and I think that's admirable.",
					"There's no shame in being the best player in the C-team, champ!",
					"You should have believed in the Heart of the Cards.",
					"Always a bridesmaid, and never the groom.",
					"You didn't win this time, but maybe one day through the power of FRIENDSHIP, FAMILY VALUES, and PATRIOTISM, you will find your way."
					];
	
	loseAdvice = 	[
					//"Success is not a good teacher, failure makes you humble.",
					//"Failure doesn't mean the game is over, it means try again with experience.",
					"Nothing has failed quite as hard as you just did. That's an achievment in itself!",
					"Don't worry. There's nothing standing between you and success except a total lack of talent.",
					"The risks you took were calculated, but man were you bad at math.",
					"You haven't failed here. You've just found 100 strategies that don't work.",
					"If at first you don't succeed, failure may be more your style.",
					"In the end we all die, and one day you won't have to bear the shame of this defeat.",
					"Man, you probably listen to Nickelback, don't you?"
					];
		
	tableHandX = 100;
	tableHandY = 100;
	
	gameStarted = false;
	
	BGIMG = new Image();
	BGIMG.src = "images/b1.png";
	
	statBG = new Image();
	statBG.src = "images/statBG.jpg"; //blueBG
	
	horizontalBG = new Image();
	horizontalBG.src = "images/horizontalBG.jpg";
	
	bannerIMG = new Image();
	bannerIMG.src = "images/banner4.png";
	
	plaque = new Image();
	plaque.src = "images/plaque10.png";
	
	specialCard = [];
	specialCard[0] = new Image();
	specialCard[1] = new Image();
	specialCard[2] = new Image();
	specialCard[3] = new Image();
	specialCard[3] = new Image();
	specialCard[4] = new Image();
	specialCard[5] = new Image();
	specialCard[6] = new Image();
	specialCard[7] = new Image();
	specialCard[7].src = "images/PNG/NewCards/"+ "card_John" +".png";
	specialCard[6].src = "images/PNG/NewCards/"+ "card_Jovan" +".png";
	specialCard[5].src = "images/PNG/NewCards/"+ "card_Rafe" +".png";
	specialCard[4].src = "images/PNG/NewCards/"+ "card_Maitland" +".png";
	specialCard[3].src = "images/PNG/NewCards/"+ "card_Thomas" +".png";
	specialCard[2].src = "images/PNG/NewCards/"+ "card_Joe" +".png";
	specialCard[1].src = "images/PNG/NewCards/"+ "card_Mike" +".png";
	specialCard[0].src = "images/PNG/NewCards/"+ "card_Julian" +".png";
	
	var suits = ["Clubs","Diamonds","Hearts","Spades"];
	var numbers = ["3","4","5","6","7","8","9","10","J","Q","K","A","2"];
	
	cardImage = new Image();
	cardImage.src = "images/PNG/NewCards/"+ "cardClubs2" +".png";
	
	bracketsImg = new Image();
	bracketsImg.src = "images/newplayers/brackets.png";
	outlineImg = new Image();
	outlineImg.src = "images/newplayers/outline.png";
	laurelImg = new Image();
	laurelImg.src = "images/laurel.png";
	
	playerID = 0; //5000
	
	pDefaultImg = [];
	pGreyImg = [];
	pWinImg = [];
	for (var i = 0; i < 8; i++)
	{
		pDefaultImg[i] = new Image();
		pGreyImg[i] = new Image();
		pWinImg[i] = new Image();
	}
	
	//these are the source images used for the selection process
	pDefaultImg[0].src = "images/newplayers/john3.png";
	pDefaultImg[1].src = "images/newplayers/jovan.png";
	pDefaultImg[2].src = "images/newplayers/thomas.png";
	pDefaultImg[3].src = "images/newplayers/rafe2.png";
	pDefaultImg[4].src = "images/newplayers/joe.png";
	pDefaultImg[5].src = "images/newplayers/mike.png";
	pDefaultImg[6].src = "images/newplayers/julian.png";
	pDefaultImg[7].src = "images/newplayers/maitland.png";
	
	
	pGreyImg[0].src = "images/newplayers/john_grey.png";
	pGreyImg[1].src = "images/newplayers/jovan_grey.png";
	pGreyImg[2].src = "images/newplayers/thomas_grey.png";
	pGreyImg[3].src = "images/newplayers/rafe_grey.png";
	pGreyImg[4].src = "images/newplayers/joe_grey.png";
	pGreyImg[5].src = "images/newplayers/mike_grey.png";
	pGreyImg[6].src = "images/newplayers/julian_grey.png";
	pGreyImg[7].src = "images/newplayers/maitland_grey.png";
	
	pNames = [];
	pNames[0] = "John";
	pNames[1] = "Jovan";
	pNames[2] = "Thomas";
	pNames[3] = "Rafe";
	pNames[4] = "Joe";
	pNames[5] = "Mike";
	pNames[6] = "Julian";
	pNames[7] = "Maitland";
	
	
	//these are the images that are shuffled and used in the actual game
	playerImg = [];
	playerImg[0] = new Image();
	playerImg[1] = new Image();
	playerImg[2] = new Image();
	playerImg[3] = new Image();
	playerImg[0].src = "images/newplayers/thomas.png";
	playerImg[1].src = "images/newplayers/john3.png";
	playerImg[2].src = "images/newplayers/rafe2.png";
	playerImg[3].src = "images/newplayers/jovan.png";
	//playerImg[4].src = "images/newplayers/julian.png";
	//playerImg[5].src = "images/newplayers/maitland.png";
	
	playerDealImg = [];
	playerDealImg[0] = new Image();
	playerDealImg[1] = new Image();
	playerDealImg[2] = new Image();
	playerDealImg[3] = new Image();
	playerDealImg[4] = new Image();
	playerDealImg[5] = new Image();
	playerDealImg[0].src = "images/newplayers/thomas_deal.png";
	playerDealImg[1].src = "images/newplayers/john_deal.png";
	playerDealImg[2].src = "images/newplayers/rafe_deal.png";
	playerDealImg[3].src = "images/newplayers/jovan_deal.png";
	//playerDealImg[4].src = "images/newplayers/julian_deal.png";
	//playerDealImg[5].src = "images/newplayers/maitland_deal.png";
	
	playerPersonality = [];
	playerPersonality[0] = "snowman"; //normal //conservative
	playerPersonality[1] = "snowman"; //conservative doubleSaver
	playerPersonality[2] = "snowman"; //doubleSaver //hangback
	//playerPersonality[3] = "normal"; //agreeable 
	playerPersonality[3] = "snowman"; //agreeable  //snowman
	
	
	playerNames = [];
	playerNames[0] = "Thomas";
	playerNames[1] = "John";
	playerNames[2] = "Rafe";
	playerNames[3] = "Jovan";
	//playerNames[4] = "Julian";
	//playerNames[5] = "Maitland";
	
	playerScore = [];
	playerPasses = [];
	playerRoundsWon = [];
	for (var i = 0; i < 4; i++)
	{
		playerScore[i] = 0;//(i*10)+10;
		//alert(playerScore[i]);
		playerPasses[i] = 0;
		playerRoundsWon[i] = 0;
	}
	
	drawBounce = false;
	
	doubleDodge = 0;
	doubleBreak = 0;
	duelMaster = 0;
	convenientPass = 0;
	conservativePlay = 0;
	conservativeFullHouse = 0;
	experimentalFiveJump = 0;
	experimentalDoubleJump = 0;
	experimentalSingleJump = 0;
	experimentalHangback = 0;
	
	playerGamesWon = [];
	playerGamesLost = [];
	playerGamesWon[0] = 0;
	playerGamesWon[1] = 0;
	playerGamesWon[2] = 0;
	playerGamesWon[3] = 0;
	playerGamesLost[0] = 0;
	playerGamesLost[1] = 0;
	playerGamesLost[2] = 0;
	playerGamesLost[3] = 0;
	
	cardBack = [];
	cardBack[0] = new Image();
	cardBack[1] = new Image();
	cardBack[2] = new Image();
	cardBack[3] = new Image();
	cardBack[0].src = "images/PNG/NewCards/"+ "cardBack_blue5" +".png";
	cardBack[1].src = "images/PNG/NewCards/"+ "cardBack_green5" +".png";
	cardBack[2].src = "images/PNG/NewCards/"+ "cardBack_red5" +".png";
	cardBack[3].src = "images/PNG/NewCards/"+ "cardBack_blue5" +".png";
	
	normalBack = [];
	normalBack[0] = new Image();
	normalBack[1] = new Image();
	normalBack[2] = new Image();
	normalBack[3] = new Image();
	normalBack[0].src = "images/PNG/NewCards/"+ "simple_yellow" +".png";
	normalBack[1].src = "images/PNG/NewCards/"+ "simple_red" +".png";
	normalBack[2].src = "images/PNG/NewCards/"+ "simple_green" +".png";
	normalBack[3].src = "images/PNG/NewCards/"+ "simple_blue" +".png";
	//changed normal_yellow to simple_yellow, etc
	
	invertedHighlight = new Image();
	invertedHighlight.src = "images/PNG/NewCards/inverted.png";
	
	crown = new Image();
	crown.src = "images/crown2.png";
	playerImageX = [130,10,680,800];
	playerImageY = [490,15,15,490];
		
	playerHand = [];
	
	function card(n,s)
	{
		this.number = n;
		this.suit = s;
				
		if(n=="3")
			this.value = 3
		else if(n=="4")
			this.value = 4
		else if(n=="5")
			this.value = 5
		else if(n=="6")
			this.value = 6
		else if(n=="7")
			this.value = 7
		else if(n=="8")
			this.value = 8
		else if(n=="9")
			this.value = 9
		else if(n=="10")
			this.value = 10
		else if(n=="J")
			this.value = 11
		else if(n=="Q")
			this.value = 12
		else if(n=="K")
			this.value = 13
		else if(n=="A")
			this.value = 14
		else if(n=="2")
			this.value = 15;
			
		if(s=="Clubs")
			this.suitValue = 1
		else if(s=="Diamonds")
			this.suitValue = 2
		else if(s=="Hearts")
			this.suitValue = 3
		else if(s=="Spades")
			this.suitValue = 4;
			
		this.img = new Image();
		this.img.src = "images/PNG/NewCards/card"+ this.suit + this.number +".png";
		//alert(this.img.src);
	}
	
	/*
	function fullscreen(eID)
	{
		var el = document.getElementById(eID);

		if (el.webkitRequestFullScreen)
		{
			el.webkitRequestFullScreen();
		}
		else
		{
			el.mozRequestFullScreen();
		}

	}
	*/
	
	function deselectPlayer(p)
	{
		document.getElementById("character"+p).src = pGreyImg[p].src;
		document.getElementById("characterSummary").innerHTML = "...";
		
		//document.getElementById("character"+playerID).src = pDefaultImg[playerID].src;
		
	}
	
	function selectPlayer(p)
	{
		document.getElementById("character"+p).src = pDefaultImg[p].src;
		document.getElementById("characterSummary").innerHTML = pSummary[p];
	}
		
	function reselectPlayer(p)
	{
		playerID = p;
		
		for (var i = 0; i < 8; i++)
		{
			document.getElementById("character"+i).src = pGreyImg[p].src;
		}
		
		document.getElementById("character"+p).src = pDefaultImg[p].src;
		document.getElementById("characterSummary").innerHTML = pSummary[p];
	}
		
	function GenerateDeck()
	{		
		//clear deck and generate it in order
		deck = [];
		deckCount = 0;
		
		for (var z = 0; z < 4; z++)
		{
			//playerHand[z] = [];
			for (var i = 0; i < 13; i++)
			{
				deck[deckCount] = new card(numbers[i],suits[z]);
				//playerHand[z][i] = new card(numbers[i],suits[z]);
				deckCount++;
			}
			
		}
		
	}
	
	function GeneratePlayerHands()
	{
		deckCount = 0;
		for (var z = 0; z < 4; z++)
		{
			playerHand[z] = [];
			for (var i = 0; i < 13; i++)
			{
				playerHand[z][i] = new card(deck[deckCount].number,deck[deckCount].suit);
				deckCount++;
			}
		}
	}
	
	function ShuffleArray(a) 
	{
		var j, x, i;
		for (i = a.length - 1; i > 0; i--) 
		{
			j = Math.floor(Math.random() * (i + 1));
			x = a[i];
			a[i] = a[j];
			a[j] = x;
		}
		return a;
	}
	
	function SortDeck(a)
	{
		var attempts = 0;
		var swap = false;
		var j, x, i;
		while (attempts < 100)
		{
			for (i = a.length - 1; i > 0; i--) 
			{
				//sort by higher value
				if(a[i].value < a[i-1].value)
				{
					j = a[i];
					a[i] = a[i-1];
					a[i-1] = j;
				}
				
				//sort by suit if value is equal
				else if(a[i].value == a[i-1].value)
				{
					if(a[i].suitValue < a[i-1].suitValue)
					{
						j = a[i];
						a[i] = a[i-1];
						a[i-1] = j;
					}
				}
				
			}
			attempts++;
		}
		
		return a;
	
	}
	
	function adaptDeck()
	{
	
		/*
		GenerateDeck();
		ShuffleArray(deck);
		//SortDeck(deck);
		GeneratePlayerHands();
		
		
		
		//FixHand(0);
		
		//FixHand(0);
		//FixHand(1);
		//FixHand(2);
		//FixHand(3);
		*/
		
		
		GenerateDeck();
		//alert(deck.length);
		//ShuffleArray(deck);
		
		//remove all cards from the player's decks
		for (var z = 0; z < 4; z++)
			playerHand[z] = [];
		
		
		var i = Math.floor(Math.random()*2);
		if(i==0)		
			playerHand[0][0] = new card("3","Clubs")
		else
		playerHand[2][0] = new card("3","Clubs");
		
		/*
		playerHand[3][0] = new card("3","Diamonds");
		playerHand[3][1] = new card("3","Spades");
		playerHand[3][2] = new card("4","Diamonds");
		playerHand[3][3] = new card("4","Spades");
		playerHand[3][4] = new card("7","Clubs");
		playerHand[3][5] = new card("7","Hearts");;
		playerHand[3][6] = new card("9","Hearts");
		playerHand[3][7] = new card("10","Spades");
		playerHand[3][8] = new card("10","Diamonds")
		playerHand[3][9] = new card("Q","Hearts");
		playerHand[3][10] = new card("Q","Spades");
		playerHand[3][11] = new card("K","Hearts");
		playerHand[3][12] = new card("K","Spades");
		*/
		/*
		playerHand[0][0] = new card("3","Diamonds");
		playerHand[0][1] = new card("4","Clubs");
		playerHand[0][2] = new card("4","Diamonds");
		playerHand[0][3] = new card("4","Spades");
		playerHand[0][4] = new card("2","Clubs");
		playerHand[0][5] = new card("2","Diamonds")
		playerHand[0][6] = new card("2","Hearts");;
		playerHand[0][7] = new card("2","Spades");
		*/		
		
		
		
		/*
		playerHand[1][0] = new card("3","Diamonds");
		playerHand[1][1] = new card("4","Diamonds");
		
		playerHand[2][0] = new card("2","Spades");
		playerHand[2][1] = new card("2","Hearts");
	
		playerHand[3][0] = new card("2","Diamonds");
		*/		
		
		//mark matching cards for deletion
		for (var i = deck.length-1; i >= 0; i--)
		{
			for (var z = 0; z < 4; z++)
			{
				for (var k = playerHand[z].length-1; k >= 0; k--)
				{
					if((playerHand[z][k].number==deck[i].number) && (playerHand[z][k].suit==deck[i].suit))
					{
						deck[i].value=5000;
					}
				}
			}
			
		}
		
		//delete cards from the main deck
		for (var i = deck.length-1; i >= 0; i--)
		{
			if(deck[i].value==5000)
				deck.splice(i,1);
		}
		
		
		//give the 4 players the remaining cards left in the deck
		deckCount = 0;
		ShuffleArray(deck);
		for (var z = 0; z < 4; z++)
		{
			
			for (var i = 0; i < 13; i++)
			{
				if(playerHand[z].length <13)
				{
					playerHand[z][playerHand[z].length] = new card(deck[deckCount].number,deck[deckCount].suit);
					deckCount++;
				}
			}
			
		}
				
		//sort all the player decks 
		SortDeck(playerHand[0]);
		SortDeck(playerHand[1]);
		SortDeck(playerHand[2]);
		SortDeck(playerHand[3]);
		
		playerHand[1] = [];
		playerHand[3] = [];
		
		deck = [];
		deckCount = 0;
		for (var z = 0; z < 4; z++)
		{
			for (var k = playerHand[z].length-1; k >= 0; k--)
			{
				deck[deckCount] = new card(playerHand[z][k].number,playerHand[z][k].suit);
				deckCount++;
			}
		}
		
		
		
		OutputDeck();
		
		
	}
	
	function SpecialStart(s)
	{
		playerHand[0] = [];
		playerHand[1] = [];
		playerHand[2] = [];
		playerHand[3] = [];
		
		if(s=="doubles")
		{
			playerHand[0][0] = new card("3","Diamonds");
			playerHand[0][1] = new card("9","Diamonds");
			playerHand[0][2] = new card("10","Spades");
			
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("9","Clubs");
			playerHand[1][2] = new card("9","Spades");
			playerHand[1][3] = new card("K","Clubs");
			playerHand[1][4] = new card("K","Spades");
		
			
			playerHand[2][0] = new card("4","Diamonds");
			playerHand[2][1] = new card("5","Clubs");
			playerHand[2][2] = new card("Q","Diamonds");
			
			playerHand[3][0] = new card("6","Diamonds");
			playerHand[3][1] = new card("7","Clubs");
			playerHand[3][2] = new card("J","Diamonds");
			playerHand[3][3] = new card("2","Spades");
			
			
		}
		else if(s=="alt")
		{
			playerHand[0][0] = new card("3","Diamonds");
			playerHand[0][1] = new card("4","Clubs");
			playerHand[0][2] = new card("10","Spades");
			
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("4","Spades");
			playerHand[1][2] = new card("Q","Clubs");
			playerHand[1][3] = new card("Q","Spades");
			playerHand[1][4] = new card("K","Clubs");
			playerHand[1][5] = new card("K","Spades");
		
			
			playerHand[2][0] = new card("4","Diamonds");
			playerHand[2][1] = new card("5","Clubs");
			playerHand[2][2] = new card("10","Diamonds");
			
			playerHand[3][0] = new card("6","Diamonds");
			playerHand[3][1] = new card("7","Clubs");
			playerHand[3][2] = new card("8","Diamonds");
			playerHand[3][3] = new card("2","Spades");
					
		}
		else if(s=="highplay")
		{
			playerHand[0][0] = new card("3","Clubs");
			playerHand[0][1] = new card("8","Clubs");
			playerHand[0][2] = new card("10","Clubs");
			
			playerHand[1][0] = new card("4","Clubs");
			playerHand[1][1] = new card("4","Spades");
			playerHand[1][2] = new card("10","Diamonds");
			playerHand[1][3] = new card("2","Hearts");
		
			playerHand[2][0] = new card("10","Spades");
			playerHand[2][1] = new card("2","Spades");
			
			playerHand[3][0] = new card("Q","Diamonds");
						
			
		}
		
		else if(s=="doubleHighplay")
		{
			playerHand[0][0] = new card("3","Clubs");
			playerHand[0][1] = new card("10","Diamonds");
			playerHand[0][2] = new card("10","Clubs");
			
			playerHand[1][0] = new card("5","Clubs");
			playerHand[1][1] = new card("5","Spades");
			playerHand[1][2] = new card("A","Diamonds");
			
			playerHand[2][0] = new card("4","Clubs");
			playerHand[2][1] = new card("4","Spades");
			playerHand[2][2] = new card("A","Hearts");
			playerHand[2][3] = new card("A","Spades");
			
			playerHand[3][0] = new card("Q","Diamonds");
			playerHand[3][1] = new card("Q","Hearts");
			
			
		}
		
		else if(s=="duel")
		{
			
			playerHand[0][0] = new card("7","Diamonds");
						
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("3","Spades");
			playerHand[1][2] = new card("4","Hearts");
			playerHand[1][3] = new card("4","Spades");
			playerHand[1][4] = new card("4","Diamonds");
			playerHand[1][5] = new card("2","Diamonds");
			
			playerHand[2][0] = new card("6","Clubs");
			playerHand[2][1] = new card("6","Diamonds");
			playerHand[2][2] = new card("J","Diamonds");
			playerHand[2][3] = new card("J","Hearts");
			playerHand[2][4] = new card("J","Spades");
			playerHand[2][5] = new card("9","Diamonds");
						
			playerHand[3][0] = new card("6","Hearts");
			playerHand[3][1] = new card("7","Hearts");
			playerHand[3][2] = new card("8","Spades");
			
			
			
		}
		
		//needs work now that we added highest doubles 
		else if(s=="openrank")
		{
			playerHand[0][0] = new card("3","Spades");
			//playerHand[0][2] = new card("6","Spades");
			
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("3","Diamonds");
			playerHand[1][2] = new card("3","Hearts");
			playerHand[1][3] = new card("4","Clubs");
			playerHand[1][4] = new card("4","Diamonds");
			playerHand[1][5] = new card("6","Spades");
			playerHand[1][6] = new card("A","Spades");
			playerHand[1][7] = new card("Q","Clubs");
			playerHand[1][8] = new card("Q","Diamonds");
			
			playerHand[2][0] = new card("6","Hearts");
			playerHand[2][1] = new card("7","Clubs");
			playerHand[2][2] = new card("7","Spades");
			playerHand[2][3] = new card("2","Spades");
			
			playerHand[3][0] = new card("9","Hearts");
			playerHand[3][1] = new card("9","Spades");
			playerHand[3][2] = new card("10","Clubs");
			playerHand[3][3] = new card("10","Diamonds");
			
			
		}
		else if(s=="doubleguess")
		{
			//playerHand[0][0] = new card("3","Spades");
			//playerHand[0][2] = new card("6","Spades");
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("4","Clubs");
			playerHand[1][2] = new card("4","Diamonds");
			playerHand[1][3] = new card("Q","Clubs");
			playerHand[1][4] = new card("Q","Diamonds");
			playerHand[1][5] = new card("2","Spades");
			
			playerHand[2][0] = new card("5","Hearts");
			playerHand[2][1] = new card("5","Spades");
			playerHand[2][2] = new card("10","Spades");
			playerHand[2][3] = new card("A","Spades");
			playerHand[2][4] = new card("2","Diamonds");
			
			playerHand[3][0] = new card("9","Hearts");
			playerHand[3][1] = new card("9","Spades");
			playerHand[3][2] = new card("Q","Spades");
			playerHand[3][3] = new card("J","Clubs");
			playerHand[3][4] = new card("J","Spades");
			playerHand[3][5] = new card("A","Clubs");
			playerHand[3][6] = new card("2","Hearts");
			/*
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("3","Diamonds");
			playerHand[1][2] = new card("4","Clubs");
			playerHand[1][3] = new card("4","Diamonds");
			playerHand[1][4] = new card("Q","Clubs");
			playerHand[1][5] = new card("Q","Diamonds");
			playerHand[1][6] = new card("K","Clubs");
			playerHand[1][7] = new card("K","Diamonds");
			
			playerHand[2][0] = new card("5","Hearts");
			playerHand[2][1] = new card("5","Spades");
			playerHand[2][2] = new card("A","Spades");
			playerHand[2][3] = new card("2","Spades");
			
			playerHand[3][0] = new card("9","Hearts");
			playerHand[3][1] = new card("9","Spades");
			playerHand[3][2] = new card("10","Clubs");
			playerHand[3][3] = new card("2","Hearts");
			*/
			
			
		}
		else if(s=="single")
		{
			playerHand[0][0] = new card("3","Clubs");
			playerHand[0][1] = new card("3","Diamonds");
			playerHand[0][2] = new card("4","Clubs");
			playerHand[0][3] = new card("4","Diamonds");
			playerHand[0][4] = new card("5","Clubs");
			playerHand[0][5] = new card("5","Diamonds");
			playerHand[0][6] = new card("6","Hearts");
			playerHand[0][7] = new card("7","Spades");
			playerHand[0][8] = new card("8","Clubs");
			playerHand[0][9] = new card("9","Diamonds");
			playerHand[0][10] = new card("10","Clubs");
			playerHand[0][11] = new card("J","Clubs");
			playerHand[0][12] = new card("J","Spades");
			//playerHand[0][2] = new card("6","Spades");
			
			playerHand[1][0] = new card("3","Spades");
			playerHand[1][1] = new card("4","Clubs");
			playerHand[1][2] = new card("4","Diamonds");
			playerHand[1][3] = new card("Q","Clubs");
			playerHand[1][4] = new card("Q","Diamonds");
			playerHand[1][5] = new card("2","Spades");
			
			playerHand[2][0] = new card("5","Hearts");
			playerHand[2][1] = new card("5","Spades");
			playerHand[2][2] = new card("10","Spades");
			playerHand[2][3] = new card("A","Spades");
			playerHand[2][4] = new card("2","Diamonds");
			
			playerHand[3][0] = new card("9","Hearts");
			playerHand[3][1] = new card("9","Spades");
			playerHand[3][2] = new card("Q","Spades");
			playerHand[3][3] = new card("J","Clubs");
			playerHand[3][4] = new card("J","Spades");
			playerHand[3][5] = new card("A","Clubs");
			playerHand[3][6] = new card("2","Hearts");
						
		}
		
		else if(s=="single_backup")
		{
			playerHand[0][0] = new card("3","Clubs");
			playerHand[0][1] = new card("4","Clubs");
			playerHand[0][2] = new card("5","Clubs");
			playerHand[0][3] = new card("6","Clubs");
			playerHand[0][4] = new card("7","Clubs");
			playerHand[0][5] = new card("8","Diamonds");
			playerHand[0][6] = new card("8","Hearts");
			playerHand[0][7] = new card("8","Spades");
			playerHand[0][8] = new card("10","Clubs");
			playerHand[0][9] = new card("J","Clubs");
			playerHand[0][10] = new card("Q","Clubs");
			playerHand[0][11] = new card("K","Clubs");
			playerHand[0][12] = new card("A","Spades");
			//playerHand[0][2] = new card("6","Spades");
			
			playerHand[1][0] = new card("3","Spades");
			playerHand[1][1] = new card("4","Clubs");
			playerHand[1][2] = new card("4","Diamonds");
			playerHand[1][3] = new card("Q","Clubs");
			playerHand[1][4] = new card("Q","Diamonds");
			playerHand[1][5] = new card("2","Spades");
			
			playerHand[2][0] = new card("5","Hearts");
			playerHand[2][1] = new card("5","Spades");
			playerHand[2][2] = new card("10","Spades");
			playerHand[2][3] = new card("A","Spades");
			playerHand[2][4] = new card("2","Diamonds");
			
			playerHand[3][0] = new card("9","Hearts");
			playerHand[3][1] = new card("9","Spades");
			playerHand[3][2] = new card("Q","Spades");
			playerHand[3][3] = new card("J","Clubs");
			playerHand[3][4] = new card("J","Spades");
			playerHand[3][5] = new card("A","Clubs");
			playerHand[3][6] = new card("2","Hearts");
						
		}
		
		else if(s=="cardanalysis")
		{
			playerHand[0][0] = new card("3","Clubs");
			playerHand[0][1] = new card("3","Diamonds");
			playerHand[0][2] = new card("3","Hearts");
			playerHand[0][3] = new card("3","Spades");
			playerHand[0][4] = new card("4","Clubs");
			playerHand[0][5] = new card("5","Clubs");
			playerHand[0][6] = new card("6","Clubs");
			playerHand[0][7] = new card("7","Clubs");
			playerHand[0][8] = new card("8","Diamonds");
			playerHand[0][9] = new card("8","Spades");
			playerHand[0][10] = new card("A","Diamonds");
			playerHand[0][11] = new card("A","Spades");
			playerHand[0][12] = new card("2","Spades");
			
			playerHand[1][0] = new card("2","Clubs");
						
			playerHand[2][0] = new card("2","Diamonds");
			
			playerHand[3][0] = new card("2","Hearts");
			
			
		}
		
		else if(s=="conservative")
		{
						
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("3","Diamonds");
			playerHand[1][2] = new card("3","Hearts");
			playerHand[1][3] = new card("5","Clubs");
			playerHand[1][4] = new card("6","Hearts");
			playerHand[1][5] = new card("9","Clubs");
			playerHand[1][6] = new card("J","Clubs");
			playerHand[1][7] = new card("J","Diamonds");
			playerHand[1][8] = new card("A","Hearts");
			
			playerHand[2][0] = new card("3","Spades");
			playerHand[2][1] = new card("4","Clubs");
			playerHand[2][2] = new card("4","Diamonds");
			playerHand[2][3] = new card("5","Hearts");
			playerHand[2][4] = new card("5","Spades");
			playerHand[2][5] = new card("10","Spades");
			playerHand[2][6] = new card("2","Clubs");
			playerHand[2][7] = new card("2","Hearts");
			playerHand[2][8] = new card("2","Diamonds");
			
			playerHand[3][0] = new card("4","Spades");
			playerHand[3][1] = new card("5","Spades");
			playerHand[3][2] = new card("7","Spades");
			playerHand[3][3] = new card("9","Clubs");
			playerHand[3][4] = new card("J","Hearts");
			playerHand[3][5] = new card("J","Spades");
			playerHand[3][6] = new card("A","Clubs");
			playerHand[3][7] = new card("A","Diamonds");
			playerHand[3][8] = new card("A","Spades");
			
			
		}
		
		else if(s=="ffs")
		{
			playerHand[0][0] = new card("2","Spades");
		
			
			
			playerHand[1][0] = new card("3","Clubs");
			playerHand[1][1] = new card("K","Clubs");
			playerHand[1][2] = new card("K","Spades");
		
			
			playerHand[2][0] = new card("4","Diamonds");
			playerHand[2][1] = new card("5","Diamonds");
			
			playerHand[3][0] = new card("6","Diamonds");
			playerHand[3][1] = new card("J","Diamonds");
			
			
		}
		deck = [];
		deckCount = 0;
		for (var z = 0; z < 4; z++)
		{
			for (var k = playerHand[z].length-1; k >= 0; k--)
			{
				deck[deckCount] = new card(playerHand[z][k].number,playerHand[z][k].suit);
				deckCount++;
			}
		}
		
		
		
	}
	
	//create a fake hand for player i to test hand detection and play
	function FixHand(i)
	{
		playerHand[0] = [];
		playerHand[1] = [];
		playerHand[2] = [];
		playerHand[3] = [];
		
		playerHand[0][0] = new card("3","Clubs");
		playerHand[1][0] = new card("3","Diamonds");
		playerHand[2][0] = new card("3","Hearts");
		playerHand[3][0] = new card("3","Spades");
		
		if(i==0)
		{
		
			playerHand[i] = [];
			playerHand[i][0] = new card("3","Diamonds");
			playerHand[i][1] = new card("6","Diamonds");
			//playerHand[i][2] = new card("9","Spades");
			//playerHand[i][3] = new card("J","Spades");
			playerHand[i][2] = new card("J","Spades");
			playerHand[i][3] = new card("2","Hearts");
		}
		
		else if(i==1)
		{
		
			playerHand[i] = [];
				playerHand[i][0] = new card("3","Clubs");
			playerHand[i][1] = new card("6","Clubs");
		
			playerHand[i][2] = new card("7","Diamonds");
			playerHand[i][3] = new card("9","Diamonds");
		
		
		}
		else if(i==2)
		{
		
			playerHand[i] = [];
			playerHand[i][0] = new card("3","Spades");
			playerHand[i][1] = new card("5","Hearts");
			playerHand[i][2] = new card("A","Diamonds");
			playerHand[i][3] = new card("2","Diamonds");
		
		
		}
		else if(i==3)
		{
		
			playerHand[i] = [];
			playerHand[i][0] = new card("4","Hearts");
			playerHand[i][1] = new card("5","Clubs");
			//playerHand[i][2] = new card("5","Diamonds");
			playerHand[i][2] = new card("Q","Spades");
			playerHand[i][3] = new card("2","Spades");
		
		
		}
		// 666-QQ
		
	}
	
	//let the player abdicate their turn
	function passButton()
	{
		if(currentPlayer==0)
		{
			playerPasses[0]++;
			showHelp = false;
			turnsPassed++;
			removePlayerControl();
			incrementTurn();
			//currentPlayer++;
			//turnNumber++;
			//alert("time to pass");
			//maybe you shouldn't be able to pass if you are the first player
		}
	}
	
	function checkForExceptionalHand()
	{
		if(attemptedHandCount==5)
		{
							
			analyseFlush(attemptedHand);
			analyseFourOfAKind(attemptedHand);
							
			if(fourHandCount>0)
			{
				success = true;
				tableRule = "four";
			}
			else if(flushHandCount>0)
			{
				success = true;
				tableRule = "flush";
			}
			
		}
		return(success);
	}
	
	//try to play the cards the player has highlighted
	function playPlayerHand()
	{
		
		success = false;
		attemptedHand = [];
		attemptedHandCount = 0;
		
		var cardsHighlighted = 0;
		for (var i = 0; i < playerHand[0].length; i++)
		{
			if(highlightedCards[i])
			{
				cardsHighlighted++;
				attemptedHand[attemptedHandCount] = new card(playerHand[0][i].number,playerHand[0][i].suit);
				attemptedHandCount++;
			}
		}
		
		//alert(cardsHighlighted);
		if((cardsHighlighted==1) || (cardsHighlighted==2) || (cardsHighlighted==5))
		{
			//alert("that looks like a valid hand");
			//alert(tableHand.length)
			
			if(tableHand.length==0)
			{
				//table is empty, any valid hand is okay
				//alert("table is empty play and valid hand");
				//also check turnNumber to see if we require 3 of clubs
				
				//it's the first turn and we need to play a hand that has a 3 of clubs in it
				if(turnNumber==0) 
				{
					if((attemptedHand[0].number=="3") && (attemptedHand[0].suit=="Clubs"))
					{
						//alert("first turn");
						if(attemptedHandCount==1)
						{
							success = true;
							tableRule = "single";
						}
						else if((attemptedHandCount==2) && (attemptedHand[0].value == attemptedHand[1].value))
						{
							success = true;
							tableRule = "double";
						}
						
						else if(attemptedHandCount==5)
						{
							//alert(attemptedHand[0].number + attemptedHand[1].number + attemptedHand[2].number + attemptedHand[3].number + attemptedHand[4].number);
							
							analyseStraight(attemptedHand);
							analyseDoubles(attemptedHand);
							//alert("doubles:"+doubleHandCount);
							
							analyseTriples(attemptedHand);
							//alert("triples:"+tripleHandCount);
							//alert("full houses:"+fullHouseHandCount);
							
							analyseFlush(attemptedHand);
							analyseFourOfAKind(attemptedHand);
							
							if(straightHandCount>0)
							{
								success = true;
								tableRule = "straight";
							}
							else if(fullHouseHandCount>0)
							{
								success = true;
								tableRule = "fullhouse";
							}
							else if(fourHandCount>0)
							{
								success = true;
								tableRule = "four";
							}
							else if(flushHandCount>0)
							{
								success = true;
								tableRule = "flush";
							}
							else
								playerHelp("You need to play the three of clubs as a single card, or as part of a pair, straight, or full house.");
						}	
						
					}
					else
						playerHelp("The opening hand must include the 3 of clubs.");
				}
				
				//the floor is yours, play any regular hand
				else
				{
					//alert("business as usual");
					if(attemptedHandCount==1)
					{
						success = true;
						tableRule = "single";
					}
					else if((attemptedHandCount==2) && (attemptedHand[0].value == attemptedHand[1].value))
					{
						success = true;
						tableRule = "double";
					}
					else if(attemptedHandCount==5)
					{
						analyseStraight(attemptedHand);
						analyseDoubles(attemptedHand);
						analyseTriples(attemptedHand);
							
						if(straightHandCount>0)
						{
							success = true;
							tableRule = "straight";
						}
						else if(fullHouseHandCount>0)
						{
							success = true;
							tableRule = "fullhouse";
						}
						else if(fourHandCount>0)
						{
							success = true;
							tableRule = "four";
						}
						else if(flushHandCount>0)
						{
							success = true;
							tableRule = "flush";
						}
					}
					
					if(success==false)
						playerHelp("You need to play a single card, pair, straight, or full house.");
										
				}
				
			}
			else
			{
				//something is on the table, check the tableRule to find out what should we play
				//alert(attemptedHandCount);
				if((tableRule=="single") && (attemptedHandCount==1) && (attemptedHand[0].value >= tableHand[0].value))
				{
					if(attemptedHand[0].value > tableHand[0].value)
						success = true
					else if ((attemptedHand[0].value == tableHand[0].value) && (attemptedHand[0].suitValue > tableHand[0].suitValue))
						success = true
					else
						playerHelp("Your single is too low. Play a higher single.");
				}
				
				else if((tableRule=="double") && (attemptedHandCount==2) && (attemptedHand[0].value >= tableHand[0].value) && (attemptedHand[0].value == attemptedHand[1].value))
				{
					if(attemptedHand[0].value > tableHand[0].value)
						success = true
					else if ((attemptedHand[0].value == tableHand[0].value) && (attemptedHand[1].suitValue > tableHand[1].suitValue))
						success = true
					else
						playerHelp("Your double is too low. Play a higher double.");
				}
				
				else if((tableRule=="straight") && (attemptedHandCount==5))
				{
					analyseStraight(attemptedHand);
					if(straightHandCount>0)
					{
						if(attemptedHand[0].value > tableHand[0].value)
							success = true
						else if((attemptedHand[0].value == tableHand[0].value) && (attemptedHand[0].suitValue > tableHand[0].suitValue))
							success = true
						else
							playerHelp("Your straight is too low. Play a higher straight.");
					}
					else if(checkForExceptionalHand())
						success = true
					else
						playerHelp("You need to play a higher " + tableRule+ " on the table.");
				}				
				
				else if((tableRule=="flush") && (attemptedHandCount==5))
				{
					analyseFlush(attemptedHand);
					if(flushHandCount>0)
					{
						if(attemptedHand[0].value > tableHand[0].value)
							success = true
						else if((attemptedHand[0].value == tableHand[0].value) && (attemptedHand[0].suitValue > tableHand[0].suitValue))
							success = true
						else
							playerHelp("Your straight flush is too low. Play a higher straight flush.");
					}
					else
						playerHelp("You need to play a higher " + tableRule+ " on the table.");
				}	
				
				else if((tableRule=="fullhouse") && (attemptedHandCount==5))
				{
					analyseDoubles(attemptedHand);
					analyseTriples(attemptedHand);
					if(fullHouseHandCount>0)
					{
						if(fullHouseHand[0][0].value > tableHand[0].value)
						//if(attemptedHand[0].value > tableHand[0].value)
							success = true
						else
							playerHelp("Your full house is too low. Play a higher full house.");
					}
					else if(checkForExceptionalHand())
						success = true
					else
						playerHelp("You need to play a higher full house on the table.");
				}
				
				else if((tableRule=="four") && (attemptedHandCount==5))
				{
					analyseFourOfAKind();
					if(fourHandCount>0)
					{
						if(fourHand[0][0].value > tableHand[0].value)
						//if(attemptedHand[0].value > tableHand[0].value)
							success = true
						else
							playerHelp("Your four of a kind is too low. Play a higher four of a kind.");
					}
					else
						playerHelp("You need to play a higher " + tableRule+ " on the table.");
				}
				else if(checkForExceptionalHand())
					success = true
				else
					playerHelp("You need to play a higher " + tableRule+ " on the table.");
			}
			
		}
		/*
		else if(cardsHighlighted==0)
		{
			playerHelp("Click on your hand to highlight the card(s) you want to play, or pass.");
		}
		else if(tableRule=="empty")
			playerHelp("The table is clear. You may play any single card, pair, straight, or full house.");
		else
			playerHelp("You need to play a higher " + tableRule+ " on the table, or pass.");
		*/
		
		//valid hand played, let's do it!
		if(success)
		{
			showHelp = false;
			TryPlay("cardPlace1");
			//create projectile cards to be animated
			for (var i = 0; i < playerHand[0].length; i++)
			{
				if(highlightedCards[i])
					CreateProjectile(0,0,i);
			}
			
			//alert("success!");
			turnsPassed = 0;
			tableOwnership = currentPlayer;
			//remove highlighted hand from the player's hand
			for (var i = playerHand[0].length-1; i >= 0; i--)
			{
				if(highlightedCards[i])
				{
					playerHand[0].splice(i,1);
				}
			}
			
			//highlightedCards = [];
			for (var i = 0; i < highlightedCards.length; i++)
				highlightedCards[i] = false;
			
			//lazy fix for how things are stitched together
			if(tableRule=="fullhouse")
			{
				//alert("fml");
				tableHand = [];
				tableHandCount = 0;
				for (var i = 0; i < fullHouseHand[0].length; i++)
				{
					tableHand[tableHandCount] = new card(fullHouseHand[0][i].number,fullHouseHand[0][i].suit);
					tableHandCount++;
				}
			}
			else 
			{
				tableHand = [];
				tableHandCount = 0;
				for (var i = 0; i < attemptedHand.length; i++)
				{
					tableHand[tableHandCount] = new card(attemptedHand[i].number,attemptedHand[i].suit);
					tableHandCount++;
				}
			}
			
			//splice the successful cards from the general purpose tracking deck
			for (var q = 0; q < tableHand.length; q++)
			{
				for (var i = deck.length-1; i >= 0; i--)
				{
					if((deck[i].number==tableHand[q].number) && (deck[i].suit==tableHand[q].suit))
						deck[i].value = 5000;
				}
			}
			for (var i = deck.length-1; i >= 0; i--)
			{
				if(deck[i].value==5000)
					deck.splice(i,1);
			}
			
			//set target for projectile cards so they move correctly to the table
			setProjectileValues();
			
			if(playerHand[0].length==0)
			{
				//alert("You got rid of all your cards! Woot!");
				//should have a thing to increase player win stats
				
				//document.getElementById("mainScreen").style.display="none";
				//document.getElementById("mobileScreen").style.display="none";
				
				if(activePlayers==4)
				{					
					//document.getElementById("winScreen").style.display="block";
					playerFinish("win");
					playerPosition[playerPosition.length] = playerNames[currentPlayer];
				
				}
				else
				{
					//document.getElementById("okayScreen").style.display="block";
					playerFinish("okay");
					playerPosition[playerPosition.length] = playerNames[currentPlayer];
				}
				
			}
			
			removePlayerControl();
			incrementTurn();
			
		}
		else
		{
			//player tried to play a garbage hand, hide it from the attempted buffer so it doesn't show up
			attempted = [];
			attemptedHandCount = 0;
			
			//give the player some helpful feedback
			if(cardsHighlighted==0)
			{
				playerHelp("Click on your hand to highlight the card(s) you want to play, or pass.");
			}
			else if(turnNumber==0) 
				playerHelp("You need to play the three of clubs as a single card, or as part of a pair, straight, or full house.");
			else if(tableRule=="empty")
				playerHelp("The table is clear. You can highlight and play any single card, pair, straight, or full house.");
			else if(tableRule=="fullhouse")
				playerHelp("You need to play a higher full house on the table, or pass.");
			else if(tableRule=="straight")
				playerHelp("You need to play a higher straight on the table, or pass.");
			else if(tableRule=="double")
				playerHelp("You need to play a higher double on the table, or pass.");
			else if(tableRule=="flush")
				playerHelp("You need to play a higher straight flush on the table, or pass.");
			else if(tableRule=="four")
				playerHelp("You need to play a higher four of a kind on the table, or pass.");
			else if(tableRule=="single")
				playerHelp("You need to play a higher single on the table, or pass.");
			else
				playerHelp("You need to play a higher " + tableRule+ " on the table, or pass.");
			
			
		}
		
	}
	
	//one of the initial startup procedures
	function magicButton()
	{
		removePlayerControl();
		analyseShit();
		stuffAnalysed = true;
		complainAboutHand();
		
		for (var i = 0; i < playerHand[0].length; i++)
			highlightedCards[i] = false;
			
	}
	
	
	function assignPlayerImages(p)
	{
		playerImg[0].src = pDefaultImg[p].src;
		playerDealImg[0].src = pWinImg[p].src;
		playerNames[0] = pNames[p];
		
		pDefaultImg.splice(p,1);
		pWinImg.splice(p,1);
		pNames.splice(p,1);
		
		for (var z = 1; z < 4; z++)
		{
			var i = Math.floor(Math.random() * pDefaultImg.length);
			
			playerImg[z].src = pDefaultImg[i].src;
			playerDealImg[z].src = pWinImg[i].src;
			playerNames[z] = pNames[i];
			
			pDefaultImg.splice(i,1);
			pWinImg.splice(i,1);
			pNames.splice(i,1);
		}
		
	}
	
	function setupBounceValues()
	{
		regeneratePlayerInfo();
		bouncingHandX = [];
		bouncingHandY = [];
		bouncingHandDX = [];
		bouncingHandDY = [];
		
		bouncingHand = [];
		bouncingHandCount = 0;
		for (var z = 0; z < 4; z++)
		{
			for (var i = 0; i < 13; i++)
			{
				rX = i*140;
				//var rX = Math.floor(Math.random() * 800);
				var rY = Math.floor(Math.random() * 125)+95;
				bouncingHand[bouncingHandCount] = new card(numbers[i],suits[z]);
				bouncingHandX[bouncingHandCount] = rX;
				bouncingHandY[bouncingHandCount] = rY;
				bouncingHandDX[bouncingHandCount] = 3.0;
				bouncingHandDY[bouncingHandCount] = 4.0;
				bouncingHandCount++;
			}
			
		}
		
		ShuffleArray(bouncingHand);
		
		bouncingHand[8] = new card("2","Clubs");
		bouncingHand[9] = new card("2","Diamonds");
		bouncingHand[10] = new card("2","Hearts");
		bouncingHand[11] = new card("2","Spades");
		
	}
	
	function projectile(x,y,pDX,pDY,t)
	{
		this.frame = 0;
		this.img = new Image();
		//this.img.src = "images/"+t+"0.png";
		this.img.src = "images/PNG/NewCards/"+ "cardBack_green5" +".png";
		this.mapX = x;
		this.mapY = y;
		this.type = t;
		this.canvas = "mobileCanvas";
		this.dx = pDX;
		this.dy = pDY;
		this.targetX = 1500;
		this.targetY = 500;
		this.speed = 1; //30
		this.moveTimer = 1;
		this.owner = "ship";
		this.stage = 0;
		this.miss = true;
		this.goal = false;
	}
	
	function CreateProjectile(x,y,i)
	{
		
		extraSpacing = 0;
			
		var cardSpacing = 43;
		var removedCards = (13-playerHand[0].length);
			
		if(playerHand[0].length>0)
			extraSpacing = Math.floor(removedCards*cardSpacing/playerHand[0].length);
			
		yAdjust = 20;
		
		//pro[pro.length] = new projectile(240+(i*28),(0*110)+490-yAdjust,1,0,"projectile_green");
		pro[pro.length] = new projectile((i*(cardSpacing+extraSpacing))+7,10+730-yAdjust,1,0,"projectile_green");
		
		//the end position is wrong, as we are using i, which is the selected card position
		//we need to know where to set the targetX/Y based on attempted hand
		if(currentPlayer==0)
			pro[pro.length-1].img.src = playerHand[0][i].img.src;
		
		if(mobileMode)
		{
			pro[pro.length-1].canvas = "mobileCanvas";
			pro[pro.length-1].mapX = (i*(cardSpacing+extraSpacing))+7;
			pro[pro.length-1].mapY = 730-yAdjust;
		}
		else
		{
			pro[pro.length-1].canvas = "primaryCanvas";
			//pro[pro.length-1].mapX = 120+(i*28)+10;
			//pro[pro.length-1].mapY = 10+380-yAdjust;
			pro[pro.length-1].mapX = 240+(i*28);
			pro[pro.length-1].mapY = 490-yAdjust;
		}
		
		//below values are garbage I think
		pro[pro.length-1].targetX = 205-((pro.length-1)*20); //205
		pro[pro.length-1].targetY = 390;//390
	
	}
	
	//this sets the targetXY for card animations, so they move to the table
	function setProjectileValues()
	{
	
		var varY = -50; //80
		var varX = 50; //50
		
		for (var i = 0; i < pro.length; i++)
		{
			if(mobileMode)
			{
				pro[i].targetX = (i*20)+160+varX;
				pro[i].targetY = 440+varY;
			}
			else
			{
				pro[i].targetX = (i*20)+300+tableHandX;
				pro[i].targetY = 20+tableHandY;
			}
		}
				
	}
	
	//set the starting positions of the card animations for AI
	function setAIProjectileValues()
	{
		var varY = -50; //80
		var varX = 50; //50
		for (var i = 0; i < pro.length; i++)
		{
			pro[i].img.src = attemptedHand[i].img.src;
			if(mobileMode)
			{
				pro[i].mapX = (i*20)+160+varX;
				pro[i].mapY = 280+varY;
			}
			else
			{
				pro[i].mapX = (i*20)+180+tableHandX;
				pro[i].mapY = 120+tableHandY;
			}
		}
	}

	function moveCards()
	{
				
		var allClear = true;
		
		for (var i = pro.length-1; i >= 0; i--)
		{
			
			pro[i].moveTimer++;
		//	if(pro[i].moveTimer>=2)
			{
				pro[i].moveTimer=1;
				pro[i].speed = 15;//15 //20
				
				
				var speed_per_tick = pro[i].speed;
				pro[i].dx = pro[i].targetX - pro[i].mapX;
				pro[i].dy = pro[i].targetY - pro[i].mapY;
				var goal_dist = Math.sqrt( (pro[i].dx * pro[i].dx) + (pro[i].dy * pro[i].dy) );
				if (goal_dist > speed_per_tick)
				{
					var ratio = speed_per_tick / goal_dist;
					var x_move = ratio * pro[i].dx ;
					var y_move = ratio * pro[i].dy;
					pro[i].mapX = x_move + pro[i].mapX;  
					pro[i].mapY = y_move + pro[i].mapY;
					allClear = false;
				}
				else
				{
					pro[i].mapX = pro[i].targetX;
					pro[i].mapY = pro[i].targetY;
					
					pro[i].goal = true;
					//pro.splice(i,1);
					
										
					
				}
				
			}
			
			
			
		}
		
		//delete all my cards if they have all reached their destination
		if(allClear)
		{
			for (var i = pro.length-1; i >= 0; i--)
			{
				pro.splice(i,1);
			}
			
		}
		
	}
	
	function isMobileDevice() 
	{
		return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
	}
	
	function TryPlay(s)
	{
/*
		if ((s == "track1") || (s == "track2") || (s == "track3") || (s == "track4"))
		{

			if (musicOn)
				document.getElementById(s).play();

			currentTrack = s;
		}

		else if (soundOn)
		{
			//if you want the same sound to reset it's look so it always plays, uncomment
			
			audioTrack = ["cardPlace1","cardPlace2","cardPlace3","cardSlide1"]
			var i = Math.floor(Math.random() * audioTrack.length);
			
			//document.getElementById(s).currentTime = 0;
			//document.getElementById(s).play();
			
			document.getElementById(audioTrack[i]).currentTime = 0;
			document.getElementById(audioTrack[i]).play();
			
		}
		*/
	}
	
	//display some help messages about how to play the game to the player
	function playerHelp(p)
	{
		showHelp = true;
		playerHint = p;
	}
	
	//randomise players for the next game and restore all values using restart(), hello()
	function startGame(p)
	{
		regeneratePlayerInfo();
		assignPlayerImages(playerID);
		restart(p);
	}
	
	//first function called at game start, sets intitial values
	function hello()
	{
		
		deckDoubles = [];
		highPair = "none";
	
		document.getElementById("menuScreen").style.display="block";
		
		
		onlineMode = false;
		if(onlineMode)
			loadData();
	
		soundOn = true;
		musicOn = false;
				
		//TryPlay("cardPlace1");
		
		playerPosition = [];
		//reset per round player stats
		for (var i = 0; i < 4; i++)
		{
			playerPasses[i] = 0;
			playerRoundsWon[i] = 0;
		}
		
		pro = [];
		animationInProgress = false;
			
		setupBounceValues();
		drawBounce = false;
		
		regeneratePlayerInfo();
		regenerateComments("pass");
		regenerateComments("highplay");
		regenerateComments("mediumplay");
		regenerateComments("lowplay");
		regenerateComments("complaint");
		regenerateComments("winningPlay");
		
		playByDefault = false;
		mouseOverCard = "none";
		
		
		
		//if(playerID!=5000)
		//	assignPlayerImages(playerID);
		
		
		//three main modes
		//devMode: shows the extra window and stats
		//testMode: ai rapidly plays against each other
		//mobileMode: paints mobile canvas and changes animation positions
		
		humanState = "play"; //"play" is default, "auto" for full testMode tilt
		testMode = false;
		devMode = false;
		if(devMode)
		{
			document.getElementById("devCanvas").style.display="block";
			document.getElementById("devExtras").style.display="block";
		}
		
		mobileMode = true;
		mobileLog = "";
		
		
		//new, just for the sake of my sanity
		//automatically hides intro screens and adjusts which css to use 
		adjustableElements = ["menuScreen","introScreen","characterScreen","winScreen","okayScreen","loseScreen","extraStats","ruleScreen","statScreen","superloseScreen","superwinScreen","superokayScreen"];
		if(mobileMode)
		{
			//document.getElementById("mobileScreen").style.display="block";
			//document.getElementById("mainScreen").style.display="none";
			//document.getElementById("menuScreen").style.display="none";
			
			//for (var i = 0; i < adjustableElements.length; i++)
			//{
			//	document.getElementById(adjustableElements[i]).classList.remove("center");
			//	document.getElementById(adjustableElements[i]).classList.add("adjustedCenter");
			//}
			
		}
		else
		{
			//document.getElementById("mobileScreen").style.display="none";
			//document.getElementById("mainScreen").style.display="block";
			//document.getElementById("menuScreen").style.display="none";
			
			for (var i = 0; i < adjustableElements.length; i++)
			{
				document.getElementById(adjustableElements[i]).classList.remove("adjustedCenter");
				document.getElementById(adjustableElements[i]).classList.add("center");
			}
				
		}
		
		
		showHelp = false;
		gameWon = false;
		totalGamesPlayed = 0;
		tableOwnership = 0;
		
		newRound = false;
		turnsPassed = 0;
		activePlayers = 4;
		waitForInput = false;
		lastPlayerComment = "";
		turnNumber = 0; // currently does nothing 
		currentPlayer = 0;
		
		attemptedHand = [];
		attemptedHandCount = 0;
		
		highlightedCards = [];
		
		tableHand = [];
		tableHandCount = 0;
		
		tableRule = "";
		
		stuffAnalysed = false;
		
		var canvas = document.getElementById("primaryCanvas");
		canvas.width = 910; //600
		canvas.height = 600; //600
		
		if(mobileMode)
		{
			var canvas = document.getElementById("animationCanvas");
			canvas.width = 650; 
			canvas.height = 900; 
		}
		else
		{
			var canvas = document.getElementById("animationCanvas");
			canvas.width = 1820; //910
			canvas.height = 880; //600
		}
		
		var canvas = document.getElementById("devCanvas");
		canvas.width = 950;
		canvas.height = 850; 
		
		var canvas = document.getElementById("mobileCanvas");
		canvas.width = 600;
		canvas.height = 850;
		
		var canvas = document.getElementById("statCanvas");
		canvas.width = 550;
		canvas.height = 650; 
		
		playerHand = [];
		
		GenerateDeck();
		ShuffleArray(deck);
		//SortDeck(deck);
		GeneratePlayerHands();
		
		SortDeck(playerHand[0]);
		SortDeck(playerHand[1]);
		SortDeck(playerHand[2]);
		SortDeck(playerHand[3]);
		
		//SpecialStart("single");
		
		//SpecialStart("doubles");
		//SpecialStart("alt");
		//SpecialStart("highplay");
		//FixHand(10);
		//SpecialStart("highplay2");
		//SpecialStart("duel");
		//SpecialStart("ffs");
		//FixHand(0);
		//FixHand(1);
		//FixHand(2);
		//FixHand(3);
		
		//adaptDeck();
		
		if(devMode)
			OutputDeck();
		
		gameStarted = true;
		
		magicButton();
		
		lastPlayer = currentPlayer;
		
		document.getElementById("loseAdvice").innerHTML = loseAdvice[Math.floor(Math.random() * loseAdvice.length)];
		document.getElementById("okayAdvice").innerHTML = okayAdvice[Math.floor(Math.random() * okayAdvice.length)];
		document.getElementById("winAdvice").innerHTML = winAdvice[Math.floor(Math.random() * winAdvice.length)];
		
		document.getElementById("superloseAdvice").innerHTML = loseAdvice[Math.floor(Math.random() * loseAdvice.length)];
		document.getElementById("superokayAdvice").innerHTML = okayAdvice[Math.floor(Math.random() * okayAdvice.length)];
		document.getElementById("superwinAdvice").innerHTML = winAdvice[Math.floor(Math.random() * winAdvice.length)];
		
		
		//if(Math.floor(Math.random() * 2)==0)
		//	document.getElementById("menuImg").src = "images/douchebag3.png"
		//else
		//	document.getElementById("menuImg").src = "images/douchebag2.png";
		SortDeck(deck);
		
		bounceTimer = 0;
		bounceTimerDirection = 1;
		bounceTimerReq = 1;
		bounceTimerReqCards = 0;
		//showCardBounce();
		
	}
	
	function LifeOrDeath(p)
	{
		playerPosition = [];
		//reset per round player stats
		for (var i = 0; i < 4; i++)
		{
			playerPasses[i] = 0;
			playerRoundsWon[i] = 0;
		}
		
		pro = [];
		animationInProgress = false;
			
		setupBounceValues();
		drawBounce = false;
		
		regeneratePlayerInfo();
		regenerateComments("pass");
		regenerateComments("highplay");
		regenerateComments("mediumplay");
		regenerateComments("lowplay");
		regenerateComments("complaint");
		regenerateComments("winningPlay");
		
		playByDefault = false;
		mouseOverCard = "none";
				
		humanState = "play"; //"play" is default, "auto" for full testMode tilt
		testMode = false;
		
		
		showHelp = false;
		gameWon = false;
		totalGamesPlayed = 0;
		tableOwnership = 0;
		
		newRound = false;
		turnsPassed = 0;
		activePlayers = 4;
		waitForInput = false;
		lastPlayerComment = "";
		turnNumber = 0; // currently does nothing 
		currentPlayer = 0;
		
		attemptedHand = [];
		attemptedHandCount = 0;
		
		highlightedCards = [];
		
		tableHand = [];
		tableHandCount = 0;
		
		tableRule = "";
		
		stuffAnalysed = false;
						
		playerHand = [];
		
		GenerateDeck();
		ShuffleArray(deck);
		//SortDeck(deck);
		GeneratePlayerHands();
		
		SortDeck(playerHand[0]);
		SortDeck(playerHand[1]);
		SortDeck(playerHand[2]);
		SortDeck(playerHand[3]);
		
		//SpecialStart("doubles");
		
		if(p=="doubleSplit")
		{
			SpecialStart("doubles");
			document.getElementById("LoDText").innerHTML = "In this demo, the AI tackles the issue of when to break doubles. Pay attention to the LEFT player (John). Usually, the AI attempts not to break doubles and will conserve them during single card rounds. However, if this behaviour was universally enforced as a rule the AI could 'get stuck' when his hand had only doubles remaining, and the remainder of the players only played singles. This situation would be especially bad if in fact the AI player had the ability to win a round by breaking one of his doubles, but decided not to do so. As a result the current AI personality attempts to conserve doubles as a general rule, even during single rounds when he has no single cards to play, BUT will break his double when he determines doing so will give him a guaranteed round win. He knows he can win a given round as he counts the cards from the start of play and is aware of the highest currently unplayed card at any time. Pay attention to how John passes on the first round of table play (because he is counting cards and knows the 2 of spades has yet to be played), but in the second bout he chooses to break his double pair and win.";
		}
		else if(p=="duel")
		{
			SpecialStart("duel");
			document.getElementById("LoDText").innerHTML = "This demo showcases the AI's affinity for basic dueling. Usually its strategy is to try to win, and then play its lowest card. However, when the last opponent only has 1 card left, it is foolish to lead low as this would allow them to win more easily. In such a desperate situation, it is better to play one's hand from highest to lowest. This behaviour can be observed from the RIGHT player against the human opponent. When Jovan finally gets a chance to play, he leads with an 8, then a 7, then a 6, and wins. If he had led with his 6 initially he would have lost instantly.";
		}
		else if(p=="highplay")
		{
			SpecialStart("highplay");
			document.getElementById("LoDText").innerHTML = "This demo showcases the ability of the AI to try deny a later player from winning before them by recognizing they have the trump card and winning first. Usually the AI would follow play with their lowest usable card. In this showcase Rafe has 2 cards: 10 and a 2. He has the intelligence to recognize he has the highest card in the game and he follows with the 2 instead of the low 10, wins the round, and then wins the game. If he had played the 10 instead, Jovan would have won by playing his Q.";}
		else if(p=="doubleHighplay")
		{
			SpecialStart("doubleHighplay");
			document.getElementById("LoDText").innerHTML = "This demo showcases the ability of the AI to try deny a later player from winning before them by recognizing they have the trump card and winning first. Usually the AI would favour opening with a low double over a high single card. In this showcase however Rafe has the intelligence to recognize he has the highest card remaining in the game and can follow up with his double and thus win easily. If he had used his default logic and led with the low double 4 he would not have won.";
		}
		else if(p=="openrank")
		{
			SpecialStart("openrank");
			document.getElementById("LoDText").innerHTML = "This demo showcases how the AI handles relative hand strength when it has the opportunity to open on an empty table. Generally speaking, the AI favours playing multiple cards / rarer hands. This means that it will prioritise full houses and straights over doubles, and doubles over ordinary singles, as this is an opportunity to dispose of more cards more quickly. However, in what scenarios is it more favourable to play a single card than a double? Arguably it is foolish to open with a high double such as double ace when the player still has low value singles in their hand. The AI thus compares the value of its lowest doubles with that of its lowest singles in order to make more of an intelligent decision. In this scenario John decides to get rid of a single 6 instead of playing the high pair of queens, but Rafe decides it is more favourable to play a pair of 7s instead of his single 6.";
		}
		else if(p=="cardanalysis")
		{
			SpecialStart("cardanalysis");
			document.getElementById("LoDText").innerHTML = "This is not a demo per se, but showcases the way in which the AI considers its cards. If you look to the right you can see a visualization of the current player's hand broken up into various components and potential plays: straights, full houses, doubles, singles, four of a kinds, and straight flushes. When the AI's turn begins, it breaks down its hand into segments such as this and decides what is the best course of action depending on several rules. An interesting area to consider is the SINGLE(S) readout. While every card in the game can be played as a 'single' the AI tries to generate and use a subselection of cards and potentially conserve valuable cards for later use. The current AI personality values doubles, and as such has chosen not to include the double 3s or double 8 in its list of single cards. As a consequence of this behaviour, the AI also protects full houses during single rounds. Currently, it will not go out of its way to protect straights however. The AI also recognizes that aces and 2s are powerful cards, and that they should be avaible for use as both doubles AND singles and has thus chosen to include them in its single list. For better or worse, another point to note is that the current alogrithm doesnt try to recognize every potential combination of cards...";
		}
		else if(p=="doubleguess")
		{
			SpecialStart("doubleguess");
			document.getElementById("LoDText").innerHTML = "This demo showcases the ability of the AI to try make an informed decision about the highest doubles in the game, and then open accordingly.";
		}
		else if(p=="conservative")
		{
			SpecialStart("conservative");
			document.getElementById("LoDText").innerHTML = "This demo showcases the AI's conservatism when it comes to using 2s. While the AI is usually quite greedy and will attempt to beat whatever is played on the table. However, when it comes to full houses requiring the use of 2s, it passes. It is generally not worth wasting so many 2s at once, as doing so removes the ability to win many single / potential double rounds and get rid of a lot of low cards. In this demo Rafe has the abiity to beat the starting full house by playing a full house with 2s, but doing so would lead to him having to choose between leading with a single 3 or double 5, and after that not have the ability to win another round and ultimately losing. Instead, he conserves his powerful cards and uses them to get rid of his low cards and ultimately wins.";
		}
		else if(p=="single")
		{
			SpecialStart("single");
			document.getElementById("LoDText").innerHTML = "Let's look at which single cards are a good idea to play.";
		}
		//SpecialStart("alt");
		//SpecialStart("highplay");
		//FixHand(10);
		//SpecialStart("highplay2");
		//SpecialStart("duel");
		//SpecialStart("ffs");
		//FixHand(0);
		//FixHand(1);
		//FixHand(2);
		//FixHand(3);
		
		//adaptDeck();
		
		if(devMode)
			OutputDeck();
		
		gameStarted = true;
		
		magicButton();
		
		lastPlayer = currentPlayer;
		
		document.getElementById("loseAdvice").innerHTML = loseAdvice[Math.floor(Math.random() * loseAdvice.length)];
		document.getElementById("okayAdvice").innerHTML = okayAdvice[Math.floor(Math.random() * okayAdvice.length)];
		document.getElementById("winAdvice").innerHTML = winAdvice[Math.floor(Math.random() * winAdvice.length)];
		
		document.getElementById("superloseAdvice").innerHTML = loseAdvice[Math.floor(Math.random() * loseAdvice.length)];
		document.getElementById("superokayAdvice").innerHTML = okayAdvice[Math.floor(Math.random() * okayAdvice.length)];
		document.getElementById("superwinAdvice").innerHTML = winAdvice[Math.floor(Math.random() * winAdvice.length)];
		
		
		SortDeck(deck);
		
		bounceTimer = 0;
		bounceTimerDirection = 1;
		bounceTimerReq = 1;
		bounceTimerReqCards = 0;
		
	}
	
	function showRuleScreen()
	{
		document.getElementById("introScreen").style.display="none";
		document.getElementById("ruleScreen").style.display="block";
		document.getElementById("menuScreen").style.display="none";
		//document.getElementById("characterScreen").style.display="block";
	}
	
	function showIntroScreen()
	{
		document.getElementById("introScreen").style.display="block";
		document.getElementById("menuScreen").style.display="none";
		document.getElementById("ruleScreen").style.display="none";
		document.getElementById("statScreen").style.display="none";
	}
	
	function showStatScreen()
	{
		document.getElementById("introScreen").style.display="none";
		document.getElementById("statScreen").style.display="block";
		document.getElementById("menuScreen").style.display="none";
		if(onlineMode)
			loadData();
	}
	
	function showCharSelect()
	{
		document.getElementById("introScreen").style.display="none";
		document.getElementById("ruleScreen").style.display="none";
		document.getElementById("characterScreen").style.display="block";
	}
	
	function showExtraStats()
	{
		document.getElementById("devExtras").style.display="none";
		document.getElementById("introScreen").style.display="none";
		document.getElementById("characterScreen").style.display="none";
		document.getElementById("winScreen").style.display="none";
		document.getElementById("okayScreen").style.display="none";
		document.getElementById("loseScreen").style.display="none";
		document.getElementById("animationCanvas").style.display="none";
		document.getElementById("extraStats").style.display="block";
	}
	
	function showCardBounce()
	{
		
		document.getElementById("introScreen").style.display="none";
		document.getElementById("menuScreen").style.display="none";
		document.getElementById("characterScreen").style.display="none";
		document.getElementById("winScreen").style.display="none";
		document.getElementById("okayScreen").style.display="none";
		document.getElementById("loseScreen").style.display="none";
		
		document.getElementById("superwinScreen").style.display="none";
		
		if(mobileMode==false)
		{
			document.getElementById("animationCanvas").style.display="block";
			document.getElementById("returnToTitle").style.display="block";
			setupBounceValues();
			drawBounce = true;
			document.getElementById("animationCanvas").style.display="block";
		}
		else
		{
			returnToTitle();
		}
	}
	
	function returnToTitle()
	{
		for (var i = 0; i < 4; i++)
		{
			playerScore[i] = 0;
		}
		
		drawBounce = false;
		document.getElementById("returnToTitle").style.display="none";
		document.getElementById("animationCanvas").style.display="none";
		document.getElementById("extraStats").style.display="none";
		document.getElementById("ruleScreen").style.display="none";
		document.getElementById("statScreen").style.display="none";
	
		document.getElementById("superwinScreen").style.display="none";
		document.getElementById("superokayScreen").style.display="none";
		document.getElementById("superloseScreen").style.display="none";
		document.getElementById("menuScreen").style.display="block";
		playerID = 0;//5000;
	}
		
	function restart(p)
	{
		playerID = p;
		hello();
		
		document.getElementById("menuScreen").style.display="none";
		document.getElementById("introScreen").style.display="none";
		document.getElementById("characterScreen").style.display="none";
		document.getElementById("winScreen").style.display="none";
		document.getElementById("okayScreen").style.display="none";
		document.getElementById("loseScreen").style.display="none";
		document.getElementById("animationCanvas").style.display="none";
		document.getElementById("extraStats").style.display="none";
		
		if(mobileMode)
		{
			document.getElementById("mobileScreen").style.display="block";
		}
		else
		{
			document.getElementById("mainScreen").style.display="block";
		}
		
	}
	
	function analyseStraight(a)
	{
		var attempts = 0;
		
		straightHand = [];
		straightHandCount = 0;
		
		for (var z = 0; z < a.length; z++)
		{
		
			var cardIndex = z;
			var cardsInSequence = 0;
			newHand = [];
			
			newHand[cardsInSequence] = new card(a[cardIndex].number,a[cardIndex].suit);
			cardsInSequence++;
			for (var i = z; i < a.length; i++)
			{
				if((a[cardIndex].value+1 == a[i].value) && (cardsInSequence<5))
				{
					
					newHand[cardsInSequence] = new card(a[i].number,a[i].suit); 
					
					cardsInSequence++;
					cardIndex = i;
				}
			}
			if(cardsInSequence==5)
			{
				straightHand[straightHandCount] = [];
				for (var k = 0; k < newHand.length; k++)
				{
					straightHand[straightHandCount][k] = new card(newHand[k].number,newHand[k].suit);
				}
				straightHandCount++;
			}
		
		}
		
	}
	
	function analyseFlush(a)
	{
		var attempts = 0;
		
		flushHand = [];
		flushHandCount = 0;
		
		for (var z = 0; z < a.length; z++)
		{
		
			var cardIndex = z;
			var cardsInSequence = 0;
			newHand = [];
			
			newHand[cardsInSequence] = new card(a[cardIndex].number,a[cardIndex].suit);
			cardsInSequence++;
			for (var i = z; i < a.length; i++)
			{
				if((a[cardIndex].value+1 == a[i].value) && (a[cardIndex].suit == a[i].suit) && (cardsInSequence<5))
				{
					newHand[cardsInSequence] = new card(a[i].number,a[i].suit); 
					cardsInSequence++;
					cardIndex = i;
				}
			}
			if(cardsInSequence==5)
			{
				flushHand[flushHandCount] = [];
				for (var k = 0; k < newHand.length; k++)
				{
					flushHand[flushHandCount][k] = new card(newHand[k].number,newHand[k].suit);
				}
				flushHandCount++;
			}
		
		}
		
	}
	
	function analyseFourOfAKind(a)
	{
	
		var attempts = 0;
		
		fourHand = [];
		fourHandCount = 0;
		
		for (var z = 0; z < a.length; z++)
		{
		
			var cardIndex = z;
			var cardsInSequence = 0;
			newHand = [];
			
			newHand[cardsInSequence] = new card(a[cardIndex].number,a[cardIndex].suit);
			cardsInSequence++;
			for (var i = z; i < a.length; i++)
			{
				if((a[cardIndex].value == a[i].value) && (a[cardIndex].suitValue != a[i].suitValue) && (cardsInSequence<4))
				{
					
					newHand[cardsInSequence] = new card(a[i].number,a[i].suit); 
					
					cardsInSequence++;
					cardIndex = i;
				}
			}
			if(cardsInSequence==4)
			{
				fourHand[fourHandCount] = [];
				for (var k = 0; k < newHand.length; k++)
				{
					fourHand[fourHandCount][k] = new card(newHand[k].number,newHand[k].suit);
				}
				fourHandCount++;
			}
		
		}
				
	}
	
	function analyseTriples(a)
	{
	
		var attempts = 0;
		
		tripleHand = [];
		tripleHandCount = 0;
		
		for (var z = 0; z < a.length; z++)
		{
		
			var cardIndex = z;
			var cardsInSequence = 0;
			newHand = [];
			
			newHand[cardsInSequence] = new card(a[cardIndex].number,a[cardIndex].suit);
			cardsInSequence++;
			for (var i = z; i < a.length; i++)
			{
				if((a[cardIndex].value == a[i].value) && (a[cardIndex].suitValue != a[i].suitValue) && (cardsInSequence<3))
				{
					
					newHand[cardsInSequence] = new card(a[i].number,a[i].suit); 
					
					cardsInSequence++;
					cardIndex = i;
				}
			}
			if(cardsInSequence==3)
			{
				tripleHand[tripleHandCount] = [];
				for (var k = 0; k < newHand.length; k++)
				{
					tripleHand[tripleHandCount][k] = new card(newHand[k].number,newHand[k].suit);
				}
				tripleHandCount++;
			}
		
		}
		
		//now that we have generated a list of triples and doubles, cross reference them
		//and generate a list of fullhouses
		fullHouseHand = [];
		fullHouseHandCount = 0;
		
		for (var i = 0; i < tripleHand.length; i++)
		{
			for (var z = 0; z < doubleHand.length; z++)
			{
				if(doubleHand[z][0].number != tripleHand[i][0].number)
				{
					fullHouseHand[fullHouseHandCount] = [];
					fullHouseHand[fullHouseHandCount][0] = new card(tripleHand[i][0].number,tripleHand[i][0].suit);
					fullHouseHand[fullHouseHandCount][1] = new card(tripleHand[i][1].number,tripleHand[i][1].suit);
					fullHouseHand[fullHouseHandCount][2] = new card(tripleHand[i][2].number,tripleHand[i][2].suit);
					fullHouseHand[fullHouseHandCount][3] = new card(doubleHand[z][0].number,doubleHand[z][0].suit);
					fullHouseHand[fullHouseHandCount][4] = new card(doubleHand[z][1].number,doubleHand[z][1].suit);
					fullHouseHandCount++;
				}
			}
		}
		
	}
	
	function analyseDoubles(a)
	{
	
		var attempts = 0;
		
		doubleHand = [];
		doubleHandCount = 0;
		
		for (var z = 0; z < a.length; z++)
		{
		
			var cardIndex = z;
			var cardsInSequence = 0;
			newHand = [];
			
			newHand[cardsInSequence] = new card(a[cardIndex].number,a[cardIndex].suit);
			cardsInSequence++;
			for (var i = z; i < a.length; i++)
			{
				if((a[cardIndex].value == a[i].value) && (a[cardIndex].suitValue != a[i].suitValue) && (cardsInSequence<2))
				{
					
					newHand[cardsInSequence] = new card(a[i].number,a[i].suit); 
					
					cardsInSequence++;
					cardIndex = i;
				}
			}
			if(cardsInSequence==2)
			{
				doubleHand[doubleHandCount] = [];
				for (var k = 0; k < newHand.length; k++)
				{
					doubleHand[doubleHandCount][k] = new card(newHand[k].number,newHand[k].suit);
				}
				doubleHandCount++;
			}
		
		}
		
		return(doubleHand);
		
	}
	
	function analyseSingles(a)
	{
	
		var attempts = 0;
		
		singleHand = [];
		singleHandCount = 0;
		
		//build a hand of singles
		for (var z = 0; z < a.length; z++)
		{
			singleHand[singleHandCount] = new card(a[z].number,a[z].suit);
			singleHandCount++;
		}
		
		//mark doubles for deletion (and triples by extension)
		for (var i = 0; i < singleHand.length; i++)
		{
			for (var z = 0; z < doubleHandCount; z++)
			{
				for (var k = 0; k < doubleHand[z].length; k++)
				{
					if((singleHand[i].number==doubleHand[z][k].number) && (singleHand[i].suit==doubleHand[z][k].suit) && (doubleHand[z][k].value < 14))
						singleHand[i].value=5000;
				}
			}
		}
		
		//[done]I think we shouldn't splice double 2 or double ace, as these are powerful singles.
		
		//but perhaps our splicing choice should also be based on the stage of the game. in duelling it's probably more
		//important to just play whatever you can as you may never get a chance to play a double 6 unless
		//you win the round?
		
		//splice doubles from our hand
		for (var i = singleHand.length-1; i >= 0; i--)
		{
			if(singleHand[i].value==5000)
			{
				singleHand.splice(i,1);
				singleHandCount--;
			}
		}
		
		
		/*
		//new improvements
		document.getElementById("LoDText").innerHTML = "";
		doublesBroken = [];
		
		//calculate number of doubles in each straight
		for (var i = 0; i < straightHand.length; i++)
		{
			doublesBroken[i] = 0;
			for (var z = 0; z < straightHand[i].length; z++)
			{
				for (var k = 0; k < doubleHand.length; k++)
				{
					if(straightHand[i][z].number==doubleHand[k][0].number)
					{
						doublesBroken[i]++;
					}
				}
			}
		}
		
		//IF we don't already have a full house, try protect straights
		//find straight with the lowest number of doubles broken that 
		//doesn't contain our highest card 
		
		//then we'll need to splice that shit off both the single array 
		//AND the double array to protect it during those play stages 
		
		//if we don't have a full house and we do have a straight,
		//try to find the straight that breaks the least amount of
		//doubles and that still gives us a high card to play
		//(MIGHT ALSO WANT TO ADD MIN DOUBLE NUMBER TO BREAK LIKE 3)
		if((fullHouseHand.length==0) && (straightHand.length>0))
		{
		
			lowestBrokenDoubles = 9;
			lowestBrokenID = 5000;
			for (var i = 0; i < doublesBroken.length; i++)
			{
				if((lowestBrokenDoubles > doublesBroken[i]) && (straightHand[i][4].value < playerHand[currentPlayer][playerHand[currentPlayer].length-1].value))
				{
					lowestBrokenDoubles = doublesBroken[i];
					lowestBrokenID = i;
				}	
			}
		
			//we found a match to try preserve the cards in that straight
			if(lowestBrokenID!=5000)
			{
				//mark doubles for deletion (and triples by extension)
				for (var i = 0; i < singleHand.length; i++)
				{
					for (var z = 0; z < straightHand[lowestBrokenID].length; z++)
					{
						if((singleHand[i].number==straightHand[lowestBrokenID][z].number) && (singleHand[i].suit==straightHand[lowestBrokenID][z].suit))
							singleHand[i].value=5000;
					}
				}
				
				///arrrrgghh but now I need to include the cut doubles
				
				//once again splice those protected cards from our hand
				for (var i = singleHand.length-1; i >= 0; i--)
				{
					if(singleHand[i].value==5000)
					{
						singleHand.splice(i,1);
						singleHandCount--;
					}
				}
				
			}
		
			var tempStr = "";
			for (var i = 0; i < doublesBroken.length; i++)
			{
				tempStr = tempStr + "Straight " + i + ": " + doublesBroken[i] + " <br/>";
			}
			tempStr = tempStr + "Lowest ID: " + lowestBrokenID;
			document.getElementById("LoDText").innerHTML = tempStr;
		}
		
		*/
		
		//if we have a triple but no double to make a full house
		//add the extra third card back into our single hand so that
		//we don't conserve it as part of the doubles 
		if((tripleHand.length>0) && (fullHouseHand.length==0))
		{
			singleHand[singleHandCount] = new card(tripleHand[0][2].number,tripleHand[0][2].suit);
			singleHandCount++;
		}
		SortDeck(singleHand);
		
	}
	
	
	
	function regeneratePlayerInfo()
	{
		
		pDefaultImg = [];
		pGreyImg = [];
		pWinImg = [];
		pSummary = [];
		for (var i = 0; i < 8; i++)
		{
			pDefaultImg[i] = new Image();
			pGreyImg[i] = new Image();
			pWinImg[i] = new Image();
		}
		
		//these are the source images used for the selection process
		pDefaultImg[0].src = "images/newplayers/john3.png";
		pDefaultImg[1].src = "images/newplayers/jovan.png";
		pDefaultImg[2].src = "images/newplayers/thomas.png";
		pDefaultImg[3].src = "images/newplayers/rafe2.png";
		pDefaultImg[4].src = "images/newplayers/joe.png";
		pDefaultImg[5].src = "images/newplayers/mike.png";
		pDefaultImg[6].src = "images/newplayers/julian.png";
		pDefaultImg[7].src = "images/newplayers/maitland.png";
		
		pGreyImg[0].src = "images/newplayers/john_grey.png";
		pGreyImg[1].src = "images/newplayers/jovan_grey.png";
		pGreyImg[2].src = "images/newplayers/thomas_grey.png";
		pGreyImg[3].src = "images/newplayers/rafe_grey.png";
		pGreyImg[4].src = "images/newplayers/joe_grey.png";
		pGreyImg[5].src = "images/newplayers/mike_grey.png";
		pGreyImg[6].src = "images/newplayers/julian_grey.png";
		pGreyImg[7].src = "images/newplayers/maitland_grey.png";
		
		pWinImg[0].src = "images/newplayers/john_deal.png";
		pWinImg[1].src = "images/newplayers/jovan_deal.png";
		pWinImg[2].src = "images/newplayers/thomas_deal.png";
		pWinImg[3].src = "images/newplayers/rafe_deal.png";
		pWinImg[4].src = "images/newplayers/joe_deal.png";
		pWinImg[5].src = "images/newplayers/mike_deal.png";
		pWinImg[6].src = "images/newplayers/julian_deal.png";
		pWinImg[7].src = "images/newplayers/maitland_deal.png";
		
		pNames = [];
		pNames[0] = "John";
		pNames[1] = "Jovan";
		pNames[2] = "Thomas";
		pNames[3] = "Rafe";
		pNames[4] = "Joe";
		pNames[5] = "Mike";
		pNames[6] = "Julian";
		pNames[7] = "Maitland";
		
		pSummary[0] = "John";
		pSummary[1] = "Jovan";
		pSummary[2] = "Thomas";
		pSummary[3] = "Rafe";
		pSummary[4] = "Joe";
		pSummary[5] = "Mike";
		pSummary[6] = "Julian";
		pSummary[7] = "Maitland";
		
		
		/*
		pSummary[0] = "And I know it's me, I know I'm a cunt. I know I'm like the most provokable person in the history of the fucking world... BUT OH MY FUCKING GOSH, you think these masks are waterproof, huh? Not as waterproof as your FACE is about to be.";;
		pSummary[1] = "I stubbed my toe on a table so all tables are spiteful. Tables are the sociopaths of the future. That or it's clearly the spirits of the forest looking for rewenge. And how shall we fight them? Looks like we're gonna have to SHOOT FROM THE HIPS.";
		pSummary[2] = "I'm going to vent my spleen all over my desktop in impotent rage, wrap it up in poetic language, and send it to you courtesy of microsoft, THOSE MOTHERFUCKING DOGS.";
		pSummary[3] = "I think you will find that that woman has no feet, and bleeds blood a milky white colour from the stumps of her ankles, which is due to an overabundance of white blood cells. You could call her a 'walking cure for cancer' but that would be inconsiderate because obviously she can't walk.";
		pSummary[4] = "And the dogs look at you with their human heads and say, 'woof, woof'. There's a lot of blood and gore, but you can still see it's Thomas.";
		pSummary[5] = "I know genocide is technically bad, but how else will we arrive at a final solution to the Catalan question?";
		pSummary[6] = "Yeah, no. I ordered a pizza but it didn't come with any salt. Needs more salt. South Africans tried to replicate the exquisite British scone but all they could come up with was a rusk. Geez! I haven't seen this much California since the Battle of Hemlock.";
		pSummary[7] = "Koreans, man. South Korea has a GREAT film industry. Have you seen 'Memories of Murder?' The low key illumination combined with the film's cinematography and diegetic sound really brought the whole thing together.";
		
		
		*/
		
		
		//john 
		//I never dream about that kind of stuff. That I know of, that is... The only dreams that I remember are generally exceedingly violent and involve me murdering lots of people
		//"You think these masks are waterproof, huh? Not as waterproof as your FACE is about to be!";
		//And I know it's me, I know I'm a cunt, I know I'm like the most provokable person in the history of the fucking world, BUT OH MY FUCKING GOSH.
		
		//rafe quotes
		//you killed whoever it was who was hunting you, and are just now hearing the lamentations of their women
		//I think you will find that that woman has no feet, and bleeds blood a milky white colour from the stumps of her ankles, which is due to an overabundance of white blood cells. You could call her a "walking cure for cancer" but that would be inconsiderate because obviously she can't walk. 
		//"My name is Novus Quint, and these are my associates.";
		
		//thomas
		//I'm going to vent my spleen all over my desktop in impotent rage, wrap it up in poetic language, and send it to you courtesy of microsoft, THOSE MOTHERFUCKING DOGS.
		
		//jovan 
		//You mess with Janari, you get the finale. Hotdog surprise
		
		//julian 
		//I haven't seen this much California since the Battle of Hemlock.
		
		for (var i = 0; i < 8; i++)
			document.getElementById("character"+i).src = pGreyImg[i].src;
	}
	
	function regenerateComments(p)
	{
		if(p=="pass")
		{
							genericPass = 		[
							"...",
							"Good grief. Pass.",
							"Goodness gracious. Pass.",
							"Fuuuuck. I pass.",
							"It's not that I *can't* play on that... I just don't want to...",
							"I fold.",
							"Fold.",
							"I fold like a cheap camping chair.",
							"I pass.",
							"Pass.",
							"Auto-pass.",
							"Aaaaand I pass.",
							"Are you secretly Gandalf or something? I pass.",
							"Take this pot o' fold",
							"Siiiigh. It must be a fold day in hell.",
							"That's above the pass mark.",
							"Hello darkness my old friend. I've come to pass with you again~",
							"P-P-P-Pass!",
							"Are you insane? I pass.",
							"Too rich for my blood.",
							"Can't you play something lower? I pass.",
							"I can't play.",
							"I have a cunning plan. Pass!",
							"Somebody else can play. Pass.",
							"Geez! Somebody wants it. I pass.",
							
							"Captain Hangback, he's our saviour, goooonnna hold onto these to play later~!",
							"Somebody should really beat that. I pass."
							
							];
		
		}
		else if(p=="highplay")
		{
			genericHighPlay = 	[
								"And now for the fun part...",
								"Suck it blue!",
								"Witness me!",
								"Boom!",
								"Feel my power!",
								"I'll send your cards to the discard graveyard!",
								"MWAHAHAHA!",
								"I can't let you win!",
								"Sorry, not sorry.",							
								"There's no way you can beat this, right?",
								"You're going to pass on that, right?",
								"Go ahead and pass.",
								"Let me win.",
								"Let me have it.",
								"Don't hate me.",
								"Nothing personal.",
								"Nothing will stop me!",							
								"Captain Burnout, he's our hero, gonna take our hand size down to zero~!",							
								"How about THESE apples."						
								];			
		}
		else if(p=="mediumplay")
		{
			genericMediumPlay = [
								"Heart of the cards, guide me!",
								"It's time to d-d-d-duel!", 
								"Please pass.",
								"Feel free to pass on this.",								
								"Fear me!",
								"I need this one.",
								"Ow.",
								"It's getting expensive.",
								"Using alllll my good cards.",
								"No regrets.",
								"I have high cards for days.",
								"I want to win.",
								"Take this!",
								"I'm here all week.",
								"Don't stop - BELIIIIIEEVING!",
								"Don't take this the wrong way.",
								"I can keep this up all day.",
								"I can win this.",
								"There's more where that came from."							
								];			
		}
		else if(p=="lowplay")
		{
			genericLowPlay = 	[
								"Nice and low.",
								"Keep it low.",
								"I'm a reasonable man.",
								"I can be humble.",
								"Finally!",
								"Yesss!",
								"Alright.",
								"OK...",
								"No pressure.",
								"This is as low as I can play.",
								"Whew.",
								"Thank goodness.",
								"I can play on that.",
								"So far, so good.",
								"Okay, okay, okay.",
								"No problem.",
								"I'm not a monster.",
								"You're welcome.",
								"Don't you dare play a high card on this.",
								"I was hoping I'd get a chance to play this."
								];
		
		}
		else if(p=="winningPlay")
		{
			winningPlay = [
							//"Shhh... no tears now, only dreams...",
							//"Well played, everyone.",
							//"Don't hate the player, hate the game.",
							//"You mad, bros?",
							
							"B-B-B-Boom!",
							"Ooooh snap.",
							"GG.",
							"Am I good, or are you guys just really, *really* bad?",
							"Man, are you guys even trying?",
							"Don't get mad, get *better*.",
							"Come on, give me a challenge!",
							"Why are you guys so bad?",
							"At least you guys tried.",
							"Better luck next time.",
							"Do you guys even strategize?",
							"If you're not first, you're last.",
							"Do you guys not know how to count cards?",
							"I don't even need good cards to beat trash like you guys.",
							"I guess I shouldn't have expected much...",
							"I can't believe you just got beaten by an idiot like me.",
							"Keep in mind that this is a STRATEGY game.",
							"Are you not entertained?",
							"Don't mind me. Just looking around to see who's gonna finish *second*.",
							"It's not important that I won, only that I had fun doing it.",
							"Don't make it so easy, guys."
							];
		}
			
		genericComplaints = [
							"Good grief...",
							"Goodness gracious...",
							"What a kak hand...",
							"What a bad hand...",
							"Jesus...",
							"Did you even shuffle the deck?",
							"What a shit hand...",
							"What a terrible hand...",
							"This is the worst hand I've ever seen!",
							"Not even God could love this hand!",
							"Well, it's all over guys..."
							];
		
		twoPlay = 			[
							"Two of spades, bitches!",
							"So close, yet so far!"
							];
		
		
		
	}
	
	function HandlePlayerComment(p)
	{
		if(p=="pass")
		{
			var i = Math.floor(Math.random() * genericPass.length);
			lastPlayerComment = genericPass[i];
			genericPass.splice(i,1);
			if(genericPass.length==0)
				regenerateComments("pass");
		}
		
		else if(p=="lowplay")
		{
			
			var i = Math.floor(Math.random() * genericLowPlay.length);
			lastPlayerComment = genericLowPlay[i];
			genericLowPlay.splice(i,1);
			if(genericLowPlay.length==0)
				regenerateComments("lowplay");
		}
		
		else if(p=="mediumplay")
		{
			
			var i = Math.floor(Math.random() * genericMediumPlay.length);
			lastPlayerComment = genericMediumPlay[i];
			genericMediumPlay.splice(i,1);
			if(genericMediumPlay.length==0)
				regenerateComments("mediumplay");
		}
		
		else if(p=="highplay")
		{
			var i = Math.floor(Math.random() * genericHighPlay.length);
			lastPlayerComment = genericHighPlay[i];
			genericHighPlay.splice(i,1);
			if(genericHighPlay.length==0)
				regenerateComments("highplay");
		}
		
		else if(p=="winningPlay")
		{
			var i = Math.floor(Math.random() * winningPlay.length);
			lastPlayerComment = winningPlay[i];
			winningPlay.splice(i,1);
			if(winningPlay.length==0)
				regenerateComments("winningPlay");
		}
		
		//lastPlayerComment = genericPlay[Math.floor(Math.random() * genericPlay.length)];
			
	}
	
	
	
	
	
	
	
	function highestDoubleOwnedBy(b)
	{
		
		highPair = "none";
		var tempDeck = [];
		for (var y = 0; y < deck.length; y++)
		{
			tempDeck[y] = new card(deck[y].number,deck[y].suit);
			//alert(tempDeck[y].number);
		}
		SortDeck(tempDeck);
		
		
		for (var y = 0; y < tempDeck.length; y++)
		{
			for (var x = 0; x < playerHand[b].length; x++)
			{
				if((tempDeck[y].number==playerHand[b][x].number) && (tempDeck[y].suit==playerHand[b][x].suit))
				{
					tempDeck[y] = "splice";
				}
			}
		}
		for (var x = tempDeck.length-1; x >= 0; x--)
		{
			if(tempDeck[x]=="splice")
				tempDeck.splice(x,1);
		}
		
		
		//deckDoubles = [];
		deckDoubles = analyseDoubles(tempDeck);
				
		analyseDoubles(playerHand[b]);
		
		var result = false;
		
		
		if(doubleHand.length >0)
		{
			if(deckDoubles.length>0)
			{
				if(doubleHand[doubleHand.length-1][1].value > deckDoubles[deckDoubles.length-1][1].value)
					result = true
				else
					result = false;
			}
			else
				result = true;
		}
		else
			result = false;
		
		if(result)
		{
			highPair = doubleHand[doubleHand.length-1][1].number;
			//alert(highPair);
		}
		else if((deckDoubles.length >0) && (result==false))
		{
			highPair = deckDoubles[deckDoubles.length-1][1].number;
			//alert(highPair);
		}
		else
			highPair = "none";
		
		return(result);
		
	}
	
	function highestCardOwnedBy(i)
	{
		
		highCard = new card(deck[deck.length-1].number,deck[deck.length-1].suit);
				
		if((playerHand[i][playerHand[i].length-1].number == deck[deck.length-1].number) && (playerHand[i][playerHand[i].length-1].suit == deck[deck.length-1].suit))
			return(true)
		else
			return(false);
	}
	
	
	
	function incrementTurn()
	{
		//find out how many players still have cards left
		activePlayers = 0;
		for (var i = 0; i < 4; i++)
		{
			if(playerHand[i].length>0)
				activePlayers++;
		}
		
		
		
		
		if(playerHand[tableOwnership].length==0)
		{
			//alert("the player who has ownership has lost all their card");
			if(turnsPassed==activePlayers)
			{
				//alert("and potentially everyone has passed??");
				turnsPassed = 0;
				tableHand = [];
				tableHandCount = 0;
				tableRule = "empty";
				newRound = true;
			}
		}
		
		else if(turnsPassed==activePlayers-1)
		{
			//looks like everyone has passed, the table should be reset to 0.
			turnsPassed = 0;
			//alert("Everyone has passed. A new round begins!");
			tableHand = [];
			tableHandCount = 0;
			tableRule = "empty";
			newRound = true;
			
		}
		
		attemptedHand = [];
		attemptedHandCount = 0;
			
		//go to next player's turn
		turnNumber++;
		var attempts = 0;
		while(attempts<4)
		{
			currentPlayer++;
			attempts++;
			
			if(currentPlayer>3)
			{
				currentPlayer = 0;
			}
			
			if(playerHand[currentPlayer].length>0)
			{
				//cool, we found a player that has cards to play
				attempts = 200;
			}
				
				
		}
		
		//find the last player before me
		lastPlayer = currentPlayer;
		var fmlattempts = 0;
		while(fmlattempts<4)
		{
			lastPlayer--;
			fmlattempts++;
			
			if(lastPlayer<0)
			{
				lastPlayer = 3;
			}
			
			if(playerHand[lastPlayer].length>0)
				fmlattempts = 200;
		}
			
		if(fmlattempts==200)
		{
			//we got a valid player, let's sweet
		}
		
		if(attempts==200)
		{
			//we got a valid player, let's play, boss.
			nextStageButton();
		}
		//else
		//{
		//	alert("we didn't find a valid player, is the game over, perhaps?");
		//}
		
		
		
		//looks like someone lost
		if(activePlayers==1)
		{
			if((testMode) && (humanState=="auto"))
			{
				playerGamesLost[currentPlayer]++;
				restart(0);
			}
			else if(currentPlayer==0)
			{
				//alert("human player came in last place");
				//document.getElementById("mainScreen").style.display="none";
				//document.getElementById("mobileScreen").style.display="none";
				//document.getElementById("loseScreen").style.display="block";
				playerGamesLost[currentPlayer]++;
				playerFinish("lose");
				playerPosition[playerPosition.length] = playerNames[currentPlayer];
				EndGame();
			}
			else
			{
				//if(currentPlayer!=0)
				//	playerPosition[playerPosition.length] = playerNames[currentPlayer];
				//human player came 2nd or 3rd
				//alert("Player " + currentPlayer + " lost!");
				//playerGamesLost[currentPlayer]++;
				//playerFinish("okay");
				//document.getElementById("mainScreen").style.display="none";
				//document.getElementById("mobileScreen").style.display="none";
				//document.getElementById("okayScreen").style.display="block";
			}
		}
				
	}
	
	function removePlayerControl()
	{
		document.getElementById("magicButton").style.display="none";
		
		document.getElementById("playHandButton").style.display="none";
		document.getElementById("passButton").style.display="none";
		
		document.getElementById("nextStageButton").style.display="block";
		//alert("control removed from the player");
		
		if(mobileMode)
		{
			document.getElementById("mobilePlay").style.display="none";
			document.getElementById("mobilePass").style.display="none";
			document.getElementById("mobileNext").style.display="block";
		}
		
	}
	
	function givePlayerControl()
	{
		document.getElementById("playHandButton").style.display="block";
		document.getElementById("passButton").style.display="block";
		
		document.getElementById("nextStageButton").style.display="none";
		//alert("control given to the player");
		
		if(mobileMode)
		{
			document.getElementById("mobilePlay").style.display="block";
			document.getElementById("mobilePass").style.display="block";
			document.getElementById("mobileNext").style.display="none";
		}
	}
	
	//progress the turn stage by 1, let's the AI say their shit and play their hands
	function nextStageButton()
	{
		
		if(animationInProgress==false)
		{
	
			if(newRound)
			{
				newRound = false;
				lastPlayerComment = "Everyone passed. It's a new round!";
				attemptedHand = [];
				attemptedHandCount = 0;
				
				//////////
				//experimental fix for the persistent player wins but 
				//shit doesn't disappear bug
				//alert("new round");
				if((currentPlayer==0) && (testMode == false))
				{
					givePlayerControl();
				}
				playerRoundsWon[currentPlayer]++;
				////////// experiment
				
				//if(playerHand[tableOwnership].length==0)
				//	incrementTurn();
				//	alert("someone finished all their cards and everyone passed");
				
			}
			
			else if(waitForInput==true)
			{
				waitForInput = false;
				incrementTurn();
			}
			
			else if(attemptedHand.length==0)
			{
				
				//alert("attempted hand is empty, so we shouldn't do shit")
				
				//lastPlayerComment = genericPlay[Math.floor(Math.random() * genericPlay.length)];
				
				//analyse the new players hand 
				analyseStraight(playerHand[currentPlayer]);
				
				analyseDoubles(playerHand[currentPlayer]);
				
				analyseTriples(playerHand[currentPlayer]);			
				analyseSingles(playerHand[currentPlayer]);
				analyseFourOfAKind(playerHand[currentPlayer]);
				analyseFlush(playerHand[currentPlayer]);
				
				highestDoubleOwnedBy(currentPlayer);
				
				
				//reset base values
				attemptedHand = [];
				attemptedHandCount = 0;
				//tableHand = [];
				//tableHandCount = 0;
				
				if(turnNumber>0)
				{
					//alert("Regular play should continue");
					if(currentPlayer!=0)
					{
						handleAITurn();
					}
					
					//return control to the player
					else
					{
						if(testMode) //turn the player into an AI
							handleAITurn()
						else
						{
							//alert("it's the player's regular turn now");
							var x = 1;
							givePlayerControl();
						}
						
					}
				}
				
				else if(turnNumber==0)
				{
					//alert("first turn of the game, bro");
					//AI should take some action and make some comments
					if(currentPlayer!=0)
					{
						handleFirstAITurn();
					}
					
					//return control to the player
					else
					{
						//alert("player is going to start the game");
						if(testMode) //turn the player into an AI
							handleFirstAITurn()
						else
						{
							var x = 1;
							givePlayerControl();
						}
					}
				
				}
				
				
			}
			
			//attemptedHand is not empty, so this means the AI tried to play a hand 
			//and we need to push that to the table, after that, we move to the next turn,
			//which restarts this function 
			else
			{
				TryPlay("cardPlace1");
				//alert("well, we've clearly tried something, so we should push that to the the table");
				
				//play my attempted hand to the table
				tableHand = [];
				tableHandCount = 0;
				for (var i = 0; i < attemptedHandCount; i++)
				{
					tableHand[tableHandCount] = new card(attemptedHand[i].number,attemptedHand[i].suit);
					tableHandCount++;
				}
				
				
				//splice the successful cards from the general purpose tracking deck
				for (var q = 0; q < tableHand.length; q++)
				{
					for (var i = deck.length-1; i >= 0; i--)
					{
						if((deck[i].number==tableHand[q].number) && (deck[i].suit==tableHand[q].suit))
							deck[i].value = 5000;
					}
				}
				for (var i = deck.length-1; i >= 0; i--)
				{
					if(deck[i].value==5000)
						deck.splice(i,1);
				}
				
				
				//new
				if(testMode==false)
				{
					for (var i = 0; i < tableHand.length; i++)
					{
						CreateProjectile(0,0,i);
					}
					setAIProjectileValues();
					setProjectileValues();
				}
					
				//splice the played cards from my hand
				for (var i = playerHand[currentPlayer].length-1; i >= 0; i--)
				{
					for (var z = 0; z < attemptedHandCount; z++)
					{
						//alert(playerHand[currentPlayer][i].number + " vs " + attemptedHand[z].number);
						if((playerHand[currentPlayer][i].number==attemptedHand[z].number) && (playerHand[currentPlayer][i].suit==attemptedHand[z].suit))
						{
							playerHand[currentPlayer][i].value=6000;
							//playerHand[currentPlayer].splice(i,1);
						}
					}
				}
				
				for (var i = playerHand[currentPlayer].length-1; i >= 0; i--)
				{
					if(playerHand[currentPlayer][i].value==6000)
						playerHand[currentPlayer].splice(i,1);
				}
				tableOwnership = currentPlayer;
				
				//this player just got rid of all their cards, woot!
				if(playerHand[currentPlayer].length==0)
				{
					//alert("You got rid of all your cards! Woot!");
					if(gameWon==false)
					{
						//first player to get rid of all their cards, nice
						gameWon = true;
						playerGamesWon[currentPlayer]++;
					}
				}
				
				incrementTurn();
				
			}
		}
	}
	
	function analyseShit()
	{
		for (var i = 0; i < 4; i++)
		{
			if(playerHand[i].length>0)
			{
				if((playerHand[i][0].number=="3") && (playerHand[i][0].suit=="Clubs"))
				{	
					startingPlayer = i;
					currentPlayer = i;
				}
			}
		}
				
		nextStageButton();
		
	}
	
	function drawPlayers()
	{
		
		//draw all of the 4 player's avatar images or their "deal with it" image
		//also draw the orange/black outlines round the player images
		for (var i = 0; i < 4; i++)
		{
			if(playerHand[i].length==0)
				document.getElementById("primaryCanvas").getContext('2d').drawImage(playerDealImg[i], playerImageX[i], playerImageY[i])		
			else
				document.getElementById("primaryCanvas").getContext('2d').drawImage(playerImg[i], playerImageX[i], playerImageY[i]);			
		
			if(currentPlayer==i)
				document.getElementById("primaryCanvas").getContext('2d').drawImage(bracketsImg, playerImageX[i], playerImageY[i])
			else
				document.getElementById("primaryCanvas").getContext('2d').drawImage(outlineImg, playerImageX[i], playerImageY[i]);		
		}
				
		//draw player 1's hand
		var z = 1;
		for (var i = 0; i < playerHand[z].length; i++)
		{
			document.getElementById("primaryCanvas").getContext('2d').drawImage(cardBack[2], 10, 125+(i*28), cardBack[2].width * 0.5, cardBack[2].height * 0.5);			
		}
		
		//draw player 2's hand
		var z = 2;
		for (var i = 0; i < playerHand[z].length; i++)
		{
			document.getElementById("primaryCanvas").getContext('2d').drawImage(cardBack[1], 595-(i*28), (z*110)-210+5, cardBack[1].width * 0.5, cardBack[1].height * 0.5);			
		}
			
		//draw player 3's hand
		var z = 3;
		for (var i = 0; i < playerHand[z].length; i++)
		{
			document.getElementById("primaryCanvas").getContext('2d').drawImage(cardBack[z], 800, 405-(i*28), cardBack[z].width * 0.5, cardBack[z].height * 0.5);			
		}
				
		//draw player 0's hand
		//also lift up cards the player has highlighted or has the mouse over
		z = 0;
		var yAjust = 0;
		for (var i = 0; i < playerHand[z].length; i++)
		{
			var adjustMe = false;
			
			if(highlightedCards[i])
			{
				yAdjust = 20;
				document.getElementById("primaryCanvas").getContext('2d').drawImage(playerHand[z][i].img, 240+(i*28), (z*110)+490-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
				document.getElementById("primaryCanvas").getContext('2d').drawImage(invertedHighlight, 240+(i*28), (z*110)+490-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
			}
			else if((mouseOverCard!="none") && (i==mouseOverCard))
			{
				yAdjust = 20;
				document.getElementById("primaryCanvas").getContext('2d').drawImage(playerHand[z][i].img, 240+(i*28), (z*110)+490-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
			}
			else
			{
				yAdjust = 0;
				document.getElementById("primaryCanvas").getContext('2d').drawImage(playerHand[z][i].img, 240+(i*28), (z*110)+490-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
			}
			
		}
				
		//draw a little crown over whoever has control over the table
		document.getElementById("primaryCanvas").getContext('2d').drawImage(crown, playerImageX[tableOwnership]+65, playerImageY[tableOwnership]+70);				
		
	}
	
	function displayStats()
	{
		var k = "";
		totalGamesPlayed = 0;
		for (var i = 0; i < 4; i++)
		{
			//k = k +"Player " +i+" WINS: " + playerGamesWon[i] + "<br/>";
			//k = k +"Player " +i+" LOSES: " + playerGamesLost[i] + "<br/>";
			//k = k + "<br/>";
			totalGamesPlayed = totalGamesPlayed + playerGamesLost[i];
		}
		
		//display percentages instead of number of games
		/*
		if(totalGamesPlayed > 0)
		{
			for (var i = 0; i < 4; i++)
			{
				var a = playerGamesWon[i]/totalGamesPlayed*100;
				a = +a.toFixed(2);
				
				var b = playerGamesLost[i]/totalGamesPlayed*100;
				b = +b.toFixed(2);
				
				//k = k +"Player " +i+" RATIO: " + playerGamesWon[i] +":"+ playerGamesLost[i] +"/"+totalGamesPlayed + "<br/>";
				k = k +"Player " +i+" WON: " + a + "%" + " (" + playerPersonality[i] +")" +  "<br/>";
				k = k +"Player " +i+" LOST: " + b + "%<br/>";
				k = k + "<br/>";
			}
		}
		
		for (var i = 0; i < playerPosition.length; i++)
		{
			k = k + "PLAYER POS: " + i + playerPosition[i] + "<br/>";
		}
		*/
		
		//analyseDoubles(playerHand[currentPlayer]);
		//k = k + "PLAYER DOUBLES: " + doubleHand.length + "<br/>";
		//tempHand = analyseDoubles(playerHand[lastPlayer]);
		//k = k + "OPPONENT: " + tempHand.length + "<br/>";
		
		k = k + "DUEL MASTER: " + duelMaster + "<br/>";
		k = k + "DOUBLE-BREAK: " + doubleBreak + "<br/>";
		k = k + "HANGBACK: " + experimentalHangback + "<br/>";
		k = k + "SINGLE JUMP: " + experimentalSingleJump + "<br/>";
		k = k + "EXP 5 JUMP: " + experimentalFiveJump + "<br/>";
		k = k + "EXP DOUBLE JUMP: " + experimentalDoubleJump + "<br/>";
		k = k + "CONSERVATIVE PLAY: " + conservativePlay + "<br/>";
		k = k + "CONSERVATIVE HOUSE: " + conservativeFullHouse + "<br/>";
		k = k + "DOUBLE-DODGE: " + doubleDodge + "<br/>";
		k = k + "CONVENIENT PASS: " + convenientPass + "<br/>";
		k = k + "<br/>";
		k = k + "Table Owned By: " + playerNames[tableOwnership] + "<br/>";
		k = k + "Current Player: " + playerNames[currentPlayer] + "<br/>";
		k = k + "Previous Player: " + playerNames[lastPlayer] + "<br/>";
		
		k = k + "<br/>";
		k = k + "TOTAL GAMES: " + totalGamesPlayed + "<br/>";
		
		k = k + "Turns Passed: " + turnsPassed + "<br/>";
		k = k + "Current Player Cards: " + playerHand[currentPlayer].length + "<br/>";
		document.getElementById("playerStats").innerHTML = k;	
		
		OutputDeck();
	}
	
	
	function wrapText(context, text, x, y, maxWidth, lineHeight) 
	{
		var words = text.split(' ');
        var line = '';

        for(var n = 0; n < words.length; n++) 
		{
			var testLine = line + words[n] + ' ';
			var metrics = context.measureText(testLine);
			var testWidth = metrics.width;
			if (testWidth > maxWidth && n > 0) 
			{
				context.fillText(line, x, y);
				line = words[n] + ' ';
				y += lineHeight;
			}
			else 
			{
				line = testLine;
			}
        }
        context.fillText(line, x, y);
     }
	
	function toRadians (angle) 
	{
		return angle * (Math.PI / 180);
	}
	
	function drawR(image,x,y,rot,c)
	{
		var canvas = document.getElementById(c);
		var context = document.getElementById(c).getContext('2d');
		
		//var x = 748;//canvas.width / 2;
		//var y = 567;//canvas.height / 2;
		var width = image.width;
		var height = image.height;

		angleInRadians = toRadians(rot);
		
		context.translate(x, y);
		context.rotate(angleInRadians);
		context.drawImage(image, -width / 2, -height / 2, width, height);
		context.rotate(-angleInRadians);
		context.translate(-x, -y);
	}
	
	function drawR2(image,x,y,rot,c,scale)
	{
		var canvas = document.getElementById(c);
		var context = document.getElementById(c).getContext('2d');
		
		//var x = 748;//canvas.width / 2;
		//var y = 567;//canvas.height / 2;
		var width = image.width;
		var height = image.height;

		angleInRadians = toRadians(rot);
		
		context.translate(x, y);
		context.rotate(angleInRadians);
		context.drawImage(image, -width / 2, -height / 2, width*scale, height*scale);
		context.rotate(-angleInRadians);
		context.translate(-x, -y);
				
	}
	
	function drawExperiment()
	{
		
		extraSpacing = 0;
			
		var cardSpacing = 43;
		var removedCards = (13-playerHand[0].length);
			
		if(playerHand[0].length>0)
			extraSpacing = Math.floor(removedCards*cardSpacing/playerHand[0].length);
		
		
		extraSpacing = 0;
		cardSpacing = 38;
		
		cardNudge = 1;
		rotInterval = 5.8; //1.8
		nudgeInterval = 8; //2
		startingRot = -(playerHand[z].length/2*rotInterval);
		currentRot = startingRot;
		//draw experimental hand
		z = 0;
		yAdjust=0;
		for (var i = 0; i < playerHand[z].length; i++)
		{
			//currentRot = startingRot+(i*rotInterval);
			
			//if(currentRot>0)
			//	cardNudge = 5
			//else
			//	cardNudge = -5;
			
			if((playerHand[z].length-i)/(playerHand[z].length)*100>50)
				cardNudge = cardNudge-nudgeInterval
			else
				cardNudge = cardNudge+nudgeInterval;
			
			//if((playerHand[z].length-i)/(playerHand[z].length)*100>50)
				currentRot = currentRot+rotInterval
			//else
			//	currentRot = currentRot-rotInterval;
			
			drawR2(playerHand[z][i].img,100+(i*(cardSpacing+extraSpacing))+7, 10+230-yAdjust+cardNudge,currentRot,"mobileCanvas",0.5)
			//drawR2(playerHand[z][i].img,100+(i*(cardSpacing+extraSpacing))+7, 10+230-yAdjust+cardNudge,currentRot,"mobileCanvas",0.5)
		}
			
	}
	
	function drawMobile()
	{
	
		if(mobileMode)
		{
			var canvas = document.getElementById("mobileCanvas");
			var context = document.getElementById("mobileCanvas").getContext('2d');
			context.clearRect(0, 0, canvas.width, canvas.height);
			
			
			document.getElementById("mobileCanvas").getContext('2d').drawImage(BGIMG,0,0)		
			
			//document.getElementById("mobileCanvas").getContext('2d').drawImage(bannerIMG,40,125)		
			
			drawR(bannerIMG,290,580,180,"mobileCanvas");
						
			
			//darken the area around the player's hand 
			if(currentPlayer==0)
			{
				context.fillStyle = 'rgba(0,0,0,0.5)';
				context.fillRect(1,715,650,445);
			}
					
			//darken the area around the AI hands
			context.fillStyle = 'rgba(0,0,0,0.5)';
			//context.fillRect(1,0,650,190); 
			context.fillRect(1,0,650,120);
			
			////////////////////////////
			//SETUP B:
			////////////////////////////
			
			playerImageX[1] = 10;
			playerImageY[1] = 10;
			
			playerImageX[2] = 210;
			playerImageY[2] = 10;
			
			playerImageX[3] = 410;
			playerImageY[3] = 10;
			
			for (var i = 1; i < 4; i++)
			{
				
				//draw player images and outlines
				if(playerHand[i].length==0)
					document.getElementById("mobileCanvas").getContext('2d').drawImage(playerDealImg[i], playerImageX[i],playerImageY[i])		
				else
					document.getElementById("mobileCanvas").getContext('2d').drawImage(playerImg[i], playerImageX[i],playerImageY[i]);			
				if(currentPlayer==i)
					document.getElementById("mobileCanvas").getContext('2d').drawImage(bracketsImg, playerImageX[i],playerImageY[i])
				else
					document.getElementById("mobileCanvas").getContext('2d').drawImage(outlineImg, playerImageX[i],playerImageY[i]);		
			
				//draw player card backs and number of cards remaining
				document.getElementById("mobileCanvas").getContext('2d').drawImage(normalBack[i], playerImageX[i]+105, playerImageY[i], normalBack[i].width * 0.5, normalBack[i].height * 0.5);
					
				mobileLog = playerHand[i].length;
				var tempXAdjust = 0;
				if(playerHand[i].length < 10)
					tempXAdjust = 15;
				context.font = "40px Arial";
				context.fillStyle = 'gold';
				context.fillText(mobileLog,playerImageX[i]+115+tempXAdjust,playerImageY[i]+62);
			}
			
			//draw ownership crown
			if(tableOwnership!=0)
				document.getElementById("mobileCanvas").getContext('2d').drawImage(crown, playerImageX[tableOwnership]+65, playerImageY[tableOwnership]+70);	
			
			
			//draw human player and player's hand
			//document.getElementById("mobileCanvas").getContext('2d').drawImage(playerImg[0], 10, 680+10);			
			
			//experimental extraspacing to space cards out over time and make them easier to click on
			extraSpacing = 0;
			
			var cardSpacing = 43;
			var removedCards = (13-playerHand[0].length);
			
			if(playerHand[0].length>0)
				extraSpacing = Math.floor(removedCards*cardSpacing/playerHand[0].length);
			
			//context.font = "50px Arial";
			//context.fillStyle = 'gold';
			//context.fillText(extraSpacing,10,400);
			
			z = 0;
			var yAjust = 0;
			for (var i = 0; i < playerHand[z].length; i++)
			{
				var adjustMe = false;
				
				if(highlightedCards[i])
				{
					yAdjust = 20;
					document.getElementById("mobileCanvas").getContext('2d').drawImage(playerHand[z][i].img, (i*(cardSpacing+extraSpacing))+7, 10+730-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
					document.getElementById("mobileCanvas").getContext('2d').drawImage(invertedHighlight, (i*(cardSpacing+extraSpacing))+7, 10+730-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
				}
				else if((mouseOverCard!="none") && (i==mouseOverCard))
				{
					yAdjust = 20;
					document.getElementById("mobileCanvas").getContext('2d').drawImage(playerHand[z][i].img, (i*(cardSpacing+extraSpacing))+7, 10+730-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
				}
				else
				{
					yAdjust = 0;
					document.getElementById("mobileCanvas").getContext('2d').drawImage(playerHand[z][i].img, (i*(cardSpacing+extraSpacing))+7, 10+730-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);	
				}
				
			}
			
			
			//drawExperiment();
			
		
			var varY = -50; //80
			var varX = 50; //50
						
			if(stuffAnalysed)
			{
			
				//if we aren't in the process of moving the player hand up to the table, draw the table
				if(animationInProgress==false)
				{
					for (var i = 0; i < tableHandCount; i++)
					{
						document.getElementById("mobileCanvas").getContext('2d').drawImage(tableHand[i].img, (i*20)+160+varX, 440+varY, tableHand[i].img.width * 0.5, tableHand[i].img.height * 0.5);			
					}
				}
				
				//show the player who is trying to play a hand and his comment
				if(currentPlayer!=0)
				{
					document.getElementById("mobileCanvas").getContext('2d').drawImage(playerImg[currentPlayer], 50+varX, 280+varY);	
					document.getElementById("mobileCanvas").getContext('2d').drawImage(bracketsImg, 50+varX, 280+varY);			
					
					//context.font = "20px Arial";
					//context.fillStyle = 'white';
					//context.fillText(lastPlayerComment,50+varX,400+varY);
										
					var maxWidth = 500;//400
					var lineHeight = 25;
					
					context.font = '16pt Calibri';
					context.fillStyle = 'white';
					
					wrapText(context, lastPlayerComment, 50+varX, 405+varY, maxWidth, lineHeight);
    					
				}
				
				if(showHelp)
				{
					
					document.getElementById("mobileCanvas").getContext('2d').drawImage(plaque, 150,80);			
			
					var maxWidth = 240; //345
					var lineHeight = 25;
					context.font = '18pt Abel'; 
					context.fillStyle = 'gold';
					context.shadowColor = "rgba(0,0,0,0.7)"; 
					context.shadowOffsetX = 1;
					context.shadowOffsetY = 1;
					context.shadowBlur = 4;
					wrapText(context, playerHint, 150+25, 140+25, maxWidth, lineHeight); //565, 138			//565+25, 188+25
					context.shadowBlur = 0;	
					context.shadowOffsetX = 0;
					context.shadowOffsetY = 0;					
				}
				
				//show the hand the player is trying to play
				for (var i = 0; i < attemptedHandCount; i++)
				{
					document.getElementById("mobileCanvas").getContext('2d').drawImage(attemptedHand[i].img, (i*20)+160+varX, 280+varY, attemptedHand[i].img.width * 0.5, attemptedHand[i].img.height * 0.5);			
				}
				
				
				//draw the animated cards moving up/down
				for (var i = 0; i < pro.length; i++)
				{
					document.getElementById(pro[i].canvas).getContext('2d').drawImage(pro[i].img, pro[i].mapX, pro[i].mapY,pro[i].img.width*0.5,pro[i].img.height*0.5);
				}
				
				
			}
				
			if(currentPlayer!=0)
			{
				context.fillStyle = 'rgba(0,0,0,0.5)';
				context.fillRect(1,715,650,445);
			}
			
		}
	
	}
	
	
	function bounceCard()
	{
	
		document.getElementById("returnToTitle").value = "RETURN TO TITLE";
		//var canvas = document.getElementById("animationCanvas");
		//canvas.width = 1820; //910
		//canvas.height = 880; //600
	
		bounceTimerReq = 2;
		
		/*
		bounceTimerReqCards++;
		if(bounceTimerReqCards>=500)
		{
			bounceTimerReqCards=0;
			bounceTimerReq = bounceTimerReq + bounceTimerDirection;
			
			if(bounceTimerReq>=3)
				bounceTimerDirection = -1;
			if(bounceTimerReq<=1)
				bounceTimerDirection = 1;
			
		}*/
	
		bounceTimer++;
		if(bounceTimer>=bounceTimerReq)
		{
		bounceTimer = 0;
		cardHeight = 200;//30
		windowHeight = 880//450;
		windowWidth = 1820; //910
		
		if(mobileMode)
		{
			windowHeight = 900//450;
			windowWidth = 700; //910
		}
				//bouncingHand.length // 8
		for (var i = 0; i < 12; i++)
		{
			if(bouncingHandX[i] < windowWidth)
			{
				bouncingHandX[i] += bouncingHandDX[i];
				bouncingHandY[i] += bouncingHandDY[i];
				bouncingHandDY[i] += 1.0
				
				if(bouncingHandY[i]+cardHeight > windowHeight)
				{
					bouncingHandY[i] = windowHeight-cardHeight;
					bouncingHandDY[i] *= -0.9
				}
								
			}
			else
			{
				//cards offscreen so regenerate
				var rX = Math.floor(Math.random() * (windowWidth-100));
				//var rY = Math.floor(Math.random() * 500);
				var rY = Math.floor(Math.random() * 125)+95;
				bouncingHandX[i] = rX;
				bouncingHandY[i] = rY;
				bouncingHandDX[i] = (Math.random()*8)+1; //3.0
				bouncingHandDY[i] = 4.0; //4.0
								
			}
		}
		
		
		for (var i = 8; i < 12; i++)
		{
			//document.getElementById("animationCanvas").getContext('2d').drawImage(bouncingHand[i].img, bouncingHandX[i], bouncingHandY[i]+90, bouncingHand[i].img.width * 0.5, bouncingHand[i].img.height * 0.5);
			document.getElementById("animationCanvas").getContext('2d').drawImage(bouncingHand[i].img, bouncingHandX[i], bouncingHandY[i]);
		
		}
		
		for (var i = 0; i < 8; i++)
		{
			document.getElementById("animationCanvas").getContext('2d').drawImage(specialCard[i], bouncingHandX[i], bouncingHandY[i]);
		}
		
		}
	}
	
	function playerStat(a,b,c,d,e,f)
	{
		this.name = a;
		this.passes = b;
		this.roundsWon = c;
		this.img = new Image();
		this.img = d;
		this.score = e;
		this.position = f;
		this.positionComment = "weeee";
		
		if(f==0)
		{
			this.positionComment = "+10 points (1st)";
			//this.score=this.score+10;
		}
		else if(f==1)
		{
			this.positionComment = "+6 points (2nd)";
			//this.score=this.score+5;
		}
		else if(f==2)
		{
			this.positionComment = "+2 points (3rd)";
			//this.score=this.score+2;
		}
		else if(f==3)
		{
			this.positionComment = "+0 points (4th)";
		}
		
	}
	
	function drawStats()
	{
		
		//playerImg[0]
		
		var tempImg = [];
		var tempName = [];
		var tempScore = [];
		var tempPasses = [];
		var tempRoundsWon = [];
		var tempPlayer = [];
		var randomComment = ["(Assistant Manager)","(Employee of the Month)","(Company Drone)","(The Intern)"]
		
		//alert(playerPosition.length);
				
		if(playerPosition.length==4)
		{
			
			for (var i = 0; i < playerPosition.length; i++)
			{
				for (var z = 0; z < playerNames.length; z++)
				if(playerPosition[i]==playerNames[z])
				{
					tempPlayer[z] = new playerStat(playerNames[z],playerPasses[z],playerRoundsWon[z],playerImg[z],playerScore[z],i);
					
				}
			}
			
			//for (var z = 0; z < playerNames.length; z++)
				//tempPlayer[z] = new playerStat(playerNames[z],playerPasses[z],playerRoundsWon[z],playerImg[z],playerScore[z]);
			
			var canvas = document.getElementById("statCanvas");
			var context = document.getElementById("statCanvas").getContext('2d');
			context.clearRect(0, 0, canvas.width, canvas.height);
																					//-159
			document.getElementById("statCanvas").getContext('2d').drawImage(statBG,0,0)		
			
			textLine = ["First place","Score: 500","Rounds Passed: 4","Rounds Won: 3"];
			
			//load text for player 0
			if(playerPosition.length==4)
			{
				tempPlayer.sort(function(a, b){return a.score - b.score;});
				tempPlayer.reverse();
				textLine = [];
				textLine[0] = tempPlayer[0].name + " " +randomComment[0];
				textLine[1] = "Score: " + tempPlayer[0].score;
				textLine[2] = "Rounds Passed: " + tempPlayer[0].passes;
				textLine[3] = "Rounds Won: " + tempPlayer[0].roundsWon;
			}
						
			var yAdj = 30;
			
			//draw winner
			document.getElementById("statCanvas").getContext('2d').drawImage(tempPlayer[0].img, 50+50, (0*150)+10+30+yAdj);	
			document.getElementById("statCanvas").getContext('2d').drawImage(laurelImg, 0+50, (0*150)-50+30+yAdj);
						
			//write text for player 0
			for (var i = 0; i < 4; i++)
			{
				var statComment = "Rounds Won: 20";
				var maxWidth = 300;//400
				var lineHeight = 25;
				context.font = '13pt Arial'; //16pt
				context.fillStyle = 'white';	//21-
				wrapText(context, textLine[i], 290, (i*lineHeight)+55+yAdj, maxWidth, lineHeight);
			}
			
			//show +points
			if(tempPlayer[0].position==3)
				context.fillStyle = 'red'
			else
				context.fillStyle = 'lime';
			wrapText(context, tempPlayer[0].positionComment, 370, (1*lineHeight)+55+yAdj, maxWidth, lineHeight);
						
			//draw 3 other opponents
			for (var i = 1; i < 4; i++)
			{
				document.getElementById("statCanvas").getContext('2d').drawImage(tempPlayer[i].img, 50, (i*110)+70+yAdj);			
				document.getElementById("statCanvas").getContext('2d').drawImage(outlineImg, 50, (i*110)+70+yAdj);			
			}
			
			for (var z = 1; z < 4; z++)
			{
				
				//prepare text array
				if(playerPosition.length==4)
				{
					textLine[0] = tempPlayer[z].name + " " +randomComment[z];
					textLine[1] = "Score: " + tempPlayer[z].score;
					textLine[2] = "Rounds Passed: " + tempPlayer[z].passes;
					textLine[3] = "Rounds Won: " + tempPlayer[z].roundsWon;
					
				}
				
				//print text array
				for (var i = 0; i < 4; i++)
				{
					var statComment = "Rounds Won: 20";
					var maxWidth = 300;//400
					var lineHeight = 25;
					context.font = '13pt Arial'; //16pt
					context.fillStyle = 'white';	//21-
					wrapText(context, textLine[i], 160, (i*lineHeight)+195+yAdj+(110*(z-1)), maxWidth, lineHeight);
				}
				
				//show +points
				if(tempPlayer[z].position==3)
					context.fillStyle = 'red'
				else
					context.fillStyle = 'lime';
				wrapText(context, tempPlayer[z].positionComment, 240, lineHeight+195+yAdj+(110*(z-1)), maxWidth, lineHeight);
			
				
			}
						
			//show the order of the players at bottom right
			/*
			for (var i = 0; i < playerPosition.length; i++)
			{
				var statComment = "Rounds Won: 20";
				var maxWidth = 300;//400
				var lineHeight = 25;
				context.font = '13pt Arial'; //16pt
				context.fillStyle = 'white';	//21-
				wrapText(context, playerPosition[i], 410, (i*lineHeight)+195+yAdj+220, maxWidth, lineHeight);
			}
			*/			
						
			//document.getElementById("statCanvas").getContext('2d').drawImage(bannerIMG, 0, 200, bannerIMG.width * 0.5, bannerIMG.height * 0.5)			
			document.getElementById("statCanvas").getContext('2d').drawImage(bannerIMG, 25, 580)			
			
		}			
	}
	
	function drawSomething()
	{
		
		drawMobile();
		drawStats();	
		
		//progress animated cards and check if animations are finished yet
		moveCards();
		if(pro.length>0)
			animationInProgress = true
		else
			animationInProgress = false;
		
		if(stuffAnalysed)
		{
			//////////////////////////////
			//LEFT SCREEN: //primary canvas
			//////////////////////////////
			//draw some primary canvas stuff
			if(mobileMode==false)
			{
							
				var canvas = document.getElementById("primaryCanvas");
				var context = document.getElementById("primaryCanvas").getContext('2d');
				context.clearRect(0, 0, canvas.width, canvas.height);
							
				document.getElementById("primaryCanvas").getContext('2d').drawImage(horizontalBG,0,0)		
				drawR(bannerIMG,390,440,180,"primaryCanvas");
			
				drawPlayers();
				
				//if we aren't in the process of moving the player hand up to the table, draw the table
				if(animationInProgress==false)
				{
					for (var i = 0; i < tableHandCount; i++)
					{
						document.getElementById("primaryCanvas").getContext('2d').drawImage(tableHand[i].img, (i*20)+300+tableHandX, 20+tableHandY, tableHand[i].img.width * 0.5, tableHand[i].img.height * 0.5);			
					}
				}
				
				if(currentPlayer!=0)
				{
				
					document.getElementById("primaryCanvas").getContext('2d').drawImage(playerImg[currentPlayer], 50+tableHandX, 200+tableHandY,200*0.5,200*0.5);	
					document.getElementById("primaryCanvas").getContext('2d').drawImage(bracketsImg, 50+tableHandX, 200+tableHandY,200*0.5,200*0.5);			
					
					var maxWidth = 500;//400
					var lineHeight = 25;
					context.font = '11.5pt Arial'; //16pt
					context.fillStyle = 'white';
					wrapText(context, lastPlayerComment, 273, 345, maxWidth, lineHeight);
						
					
				}
				
				if(showHelp)
				{
					document.getElementById("primaryCanvas").getContext('2d').drawImage(plaque, 113,123);			
				
					var maxWidth = 240; //345
					var lineHeight = 25;
					context.font = '18pt Abel'; //16pt //12 	//arial
					context.fillStyle = 'gold';
					context.shadowColor = "rgba(0,0,0,0.7)"; 
					context.shadowOffsetX = 1;
					context.shadowOffsetY = 1;
					context.shadowBlur = 4;
					wrapText(context, playerHint, 115+25, 183+25, maxWidth, lineHeight); //565, 138			//565+25, 188+25
					context.shadowBlur = 0;
					context.shadowOffsetX = 0;
					context.shadowOffsetY = 0;
				}	
				
				
				//show the hand the player is trying to play
				for (var i = 0; i < attemptedHandCount; i++)
				{
					document.getElementById("primaryCanvas").getContext('2d').drawImage(attemptedHand[i].img, (i*20)+180+tableHandX, 120+tableHandY, attemptedHand[i].img.width * 0.5, attemptedHand[i].img.height * 0.5);			
				}
			
			
			}
						
			//////////////////////////////
			//DEV SCREEN: devCanvas
			//////////////////////////////
			//draw stuff to devCanvas if it's enabled
			if(devMode)
			{
				
				var canvas = document.getElementById("devCanvas");
				var context = document.getElementById("devCanvas").getContext('2d');
				context.clearRect(0, 0, canvas.width, canvas.height);
				
				//draw 3 opponents
				for (var i = 1; i < 4; i++)
				{
					document.getElementById("devCanvas").getContext('2d').drawImage(playerImg[i], 10, (i*110)-110+10);	
					//document.getElementById("devCanvas").getContext('2d').drawImage(playerImg[i], 10, (i*110)-110+10,200*0.5,200*0.5);			
				}
				
				//output the 3 opponent hands
				for (var z = 1; z < 4; z++)
				{
					for (var i = 0; i < playerHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(playerHand[z][i].img, 120+(i*28), (z*110)-110+10, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5);
					}
				}
				
				//draw player and player's hand
				document.getElementById("devCanvas").getContext('2d').drawImage(playerImg[0], 10, 350+10);			
				
				z = 0;
				var yAjust = 0;
				for (var i = 0; i < playerHand[z].length; i++)
				{
					if(highlightedCards[i])
						yAdjust = 20
					else
						yAdjust = 0;
						
					document.getElementById("devCanvas").getContext('2d').drawImage(playerHand[z][i].img, 120+(i*28), 10+350-yAdjust, playerHand[z][i].img.width * 0.5, playerHand[z][i].img.height * 0.5)			
				}
				
				//draw the current player selection thingy
				if(currentPlayer==0)
					document.getElementById("devCanvas").getContext('2d').drawImage(bracketsImg, 10, 350+10)			
				else
					document.getElementById("devCanvas").getContext('2d').drawImage(bracketsImg, 10, (currentPlayer*110)-110+10);			
			
				context.font = "16px Arial";
				context.fillStyle = 'white';
				context.fillText("STRAIGHT(S)",10,490);
				
				//display straights
				//analyseStraight(playerHand[0]);
				for (var z = 0; z < straightHand.length; z++)
				{
					for (var i = 0; i < straightHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(straightHand[z][i].img, 10+(i*20), 500+(z*50), straightHand[z][i].img.width * 0.5, straightHand[z][i].img.height * 0.5)			
					}
				}
				
				
				//display doubles
				//analyseDoubles(playerHand[0]);
				for (var z = 0; z < doubleHand.length; z++)
				{
					for (var i = 0; i < doubleHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(doubleHand[z][i].img, 360+(i*20), 500+(z*50), doubleHand[z][i].img.width * 0.5, doubleHand[z][i].img.height * 0.5)			
					}
				}
				context.fillText("DOUBLE(S)",360,490);
				
				/*
				for (var z = 0; z < deckDoubles.length; z++)
				{
					for (var i = 0; i < deckDoubles[z].length; i++)
					{																										//50
						document.getElementById("devCanvas").getContext('2d').drawImage(deckDoubles[z][i].img, 760+(i*20), 10+(z*25), deckDoubles[z][i].img.width * 0.5, deckDoubles[z][i].img.height * 0.5)			
					}
				}
				*/
				
				//display triples
				for (var z = 0; z < tripleHand.length; z++)
				{
					for (var i = 0; i < tripleHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(tripleHand[z][i].img, 480+(i*20), 500+(z*50), tripleHand[z][i].img.width * 0.5, tripleHand[z][i].img.height * 0.5)			
					}
				}
				context.fillText("TRIPLE(S)",480,490);
				
				//display full houses
				for (var z = 0; z < fullHouseHand.length; z++)
				{
					for (var i = 0; i < fullHouseHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(fullHouseHand[z][i].img, 180+(i*20), 500+(z*50), fullHouseHand[z][i].img.width * 0.5, fullHouseHand[z][i].img.height * 0.5)			
					}
				}
				context.fillText("FULL HOUSE(S)",180,490);
				
				//display singles
				for (var z = 0; z < singleHand.length; z++)
				{
					document.getElementById("devCanvas").getContext('2d').drawImage(singleHand[z].img, 620+(z*20), 500, singleHand[z].img.width * 0.5, singleHand[z].img.height * 0.5)			
				}
				context.fillText("SINGLE(S)",620,490);
				
				//display any four of a kinds
				for (var z = 0; z < fourHand.length; z++)
				{
					for (var i = 0; i < fourHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(fourHand[z][i].img, 620+(i*20), 620+(z*50), fourHand[z][i].img.width * 0.5, fourHand[z][i].img.height * 0.5)			
					}
				}
				context.fillText("4 OF A KIND(S)",620,614);
				
				//display any straight flushes
				for (var z = 0; z < flushHand.length; z++)
				{
					for (var i = 0; i < flushHand[z].length; i++)
					{
						document.getElementById("devCanvas").getContext('2d').drawImage(flushHand[z][i].img, 620+(i*20), 750+(z*50), flushHand[z][i].img.width * 0.5, flushHand[z][i].img.height * 0.5)			
					}
				}
				context.fillText("STRAIGHT FLUSH",620,745);
				
			}
						
			//draw the weird bouncing card screen if it's enabled
			if(drawBounce)
				bounceCard();
			
		}
		
		//draw the animated cards moving up/down
		for (var i = 0; i < pro.length; i++)
		{
			document.getElementById(pro[i].canvas).getContext('2d').drawImage(pro[i].img, pro[i].mapX, pro[i].mapY,pro[i].img.width*0.5,pro[i].img.height*0.5);
		}
		
	}
	
	function OutputDeck()
	{
		
		
		var tempV = "<br/>Unplayed Cards: <br/><br/>";
		for (var i = 0; i < deck.length; i++)
		{
			tempV = tempV + deck[i].number + " of " + deck[i].suit + "<br />";
		}
		
		tempV = tempV + "<br />(!)" + deck[deck.length-1].number + " of " + deck[deck.length-1].suit + "<br />";
				
		tempK = highPair;
		
		tempV = tempV + "<br />(?)" + deckDoubles.length + "<br />";
		tempV = tempV + "<br />(?)" + tempK + "<br />";
		
		document.getElementById("deckOutput").innerHTML = tempV;
		//document.getElementById("deckOutput").innerHTML = "";
				
		drawSomething();				
	}
	
	function complainAboutHand()
	{
	
		//complain about the starting hand
		var tempV = "";
		//add a random generic complaint
		tempV = tempV + genericComplaints[Math.floor(Math.random() * genericComplaints.length)] + "<br />";
				
		var cardsOverTen = 0;
		var hasTwo = false;
		var hasAce = false;
		for (var i = 0; i < playerHand[0].length; i++)
		{
			if(playerHand[0][i].value > 10)
				cardsOverTen++;
			if(playerHand[0][i].number=="A")
				hasAce = true;
			if(playerHand[0][i].number=="2")
				hasTwo = true;
		}
		if(cardsOverTen <=3)
		{
			if(cardsOverTen==0)
				tempV = tempV + "Grief! I don't have a single card over ten!" + "<br/>"
			else if(cardsOverTen==1)
				tempV = tempV + "Why does God hate me? I have ONE card over ten." + "<br/>"
			else
				tempV = tempV + "I only have " +cardsOverTen + " cards over ten!" + "<br/>";
		}
		
		if(straightHand.length==0)
			tempV = tempV + "I almost got a straight, but instead I got nothing." + "<br/>";
		
		if((hasAce==false) && (hasTwo==false))
			tempV = tempV + "I don't even have any twos OR aces!" + "<br/>"
		else if(hasAce==false)
			tempV = tempV + "I don't even have an ace." + "<br/>"
		else if(hasTwo==false)
			tempV = tempV + "I don't even have a two." + "<br/>";
		
		document.getElementById("playerComplaints").innerHTML = tempV;
	}
	
	
	
	function canvasClick(event)
	{
		
		if(currentPlayer==0)
		{
		
			if(mobileMode)
			{
				var xAdustments = -19;
				var yAjustments = -722;
				var xBounds = 585;
				var yBounds = 126;
				var cardSpacing = 43;
				var lastCardX = 516;
				
				extraSpacing = 0;
				var removedCards = (13-playerHand[0].length);
				if(playerHand[0].length>0)
					extraSpacing = Math.floor(removedCards*cardSpacing/playerHand[0].length);
							
			}
			else
			{
				extraSpacing = 0;
				var xAdustments = -131-10-110;
				var yAjustments = -433+20-10-59;
				//var xBounds = 405;
				var yBounds = 115;
				var cardSpacing = 28;
				var lastCardX = Math.floor(playerHand[0].length*cardSpacing)-1; //338
				var xBounds = lastCardX +42;
			}
			
			var x = event.clientX+xAdustments;
			var y = event.clientY+yAjustments;
			var selectedCard = "none";
			
			if((x>=0) && (x<xBounds) && (y>=0) && (y <yBounds))
			{
				if (x>lastCardX)
					selectedCard = playerHand[0].length-1;
				else
					//selectedCard = Math.floor(x/cardSpacing);
					selectedCard = Math.floor(x/(cardSpacing+extraSpacing));
			}
			
			if(selectedCard!="none")
			{
				if(highlightedCards[selectedCard])
					highlightedCards[selectedCard] = false
				else
					highlightedCards[selectedCard] = true;
				 mobileLog = x + ";" + y + ":" + playerHand[0][selectedCard].number +" of "+playerHand[0][selectedCard].suit;
				//document.getElementById("playerComplaints").innerHTML = x + ";" + y + ":" + playerHand[0][selectedCard].number +" of "+playerHand[0][selectedCard].suit;
				//CreateProjectile(0,0,selectedCard);
			}
			else
				mobileLog = x + ";" + y + ":" + selectedCard;
			//else
			//	document.getElementById("playerComplaints").innerHTML = x + ";" + y + ":" + selectedCard;
			
		}
		
		
		
	}
	
	function canvasMove(event)
	{
		
		if(mobileMode)
		{
			var xAdustments = -19+5;
			var yAjustments = -722;
			//var xBounds = 585;
			var yBounds = 126;
			var cardSpacing = 43//43;
			//var lastCardX = 516;
			var lastCardX = Math.floor(playerHand[0].length*cardSpacing)-1;
			var xBounds = lastCardX +28;
		}
		else
		{
			var xAdustments = -131-10-110;
			var yAjustments = -433+20-10-59;
			//var xBounds = 405;
			var yBounds = 115;
			var cardSpacing = 28;
			var lastCardX = Math.floor(playerHand[0].length*cardSpacing)-1; //338
			var xBounds = lastCardX +42;
		}
		
		var x = event.clientX+xAdustments;
		var y = event.clientY+yAjustments;
		
		
		if((x>=0) && (x<xBounds) && (y>=0) && (y <yBounds))
		{
			if (x>lastCardX)
				mouseOverCard = playerHand[0].length-1;
			else
				mouseOverCard = Math.floor(x/cardSpacing);
		}
		else
			mouseOverCard = "none";
		
		if(mouseOverCard!="none")
		{
			//if(highlightedCards[mouseOverCard])
			//	highlightedCards[mouseOverCard] = false
			//else
			//	highlightedCards[mouseOverCard] = true;
		}
		
		//lastPlayerComment = x + ";" + y + ". mCard: " + mouseOverCard + ". lastCardX: " + lastCardX;
		
	}
	
	function EndGame()
	{
		
		//hide the game board
		document.getElementById("mainScreen").style.display="none";
		document.getElementById("mobileScreen").style.display="none";
		document.getElementById("devExtras").style.display="none";
		
		testMode = false;
		
		if(playerPosition.length==3)
			playerPosition[playerPosition.length] = playerNames[currentPlayer];
		
		//alert("engame triggered");
		//alert(playerPosition.length);
		
		//check if anyone has got enough points to end the whole game yet
		var finalRound = false; 
		
		for (var i = 0; i < playerPosition.length; i++)
		{
			for (var z = 0; z < playerNames.length; z++)
			if(playerPosition[i]==playerNames[z])
			{
				if(i==0)
					playerScore[z] = playerScore[z] + 10
				else if(i==1)
					playerScore[z] = playerScore[z] + 6
				else if(i==2)
					playerScore[z] = playerScore[z] + 2
				else if(i==3)
					playerScore[z] = playerScore[z] + 0;
				
				if(playerScore[z] >= 30) //30
					finalRound=true;
			}
		}
		
		//game is truly over, show our final super screens instead of the stat board
		if(finalRound)
		{
			var biggestScore = 0;
			var lowestScore = 9999;
			var biggestPlayerID = 0;
			var lowestPlayerID = 0;
			for (var z = 0; z < playerNames.length; z++)
			{
				if(playerScore[z]>biggestScore)
				{
					biggestScore = playerScore[z];
					biggestPlayerID = z;
				}
				
				if(playerScore[z]<lowestScore)
				{
					lowestScore = playerScore[z];
					lowestPlayerID = z;
				}				
			}
			
			if(biggestPlayerID==0)
			{
				document.getElementById("superwinScreen").style.display="block";
				
			}
			else if(lowestPlayerID==0)
				document.getElementById("superloseScreen").style.display="block"
			else
				document.getElementById("superokayScreen").style.display="block";
		}
		
		//nope, we aren't finished yet, show our scoreboard and regular win/okay/lose screens
		else
		{
			//alert(humanState);
			if(humanState=="lose")
			{
				document.getElementById("loseScreen").style.display="block";
			}
			else if(humanState=="okay")
			{
				document.getElementById("okayScreen").style.display="block";
			}
			else if(humanState=="win")
			{
				document.getElementById("winScreen").style.display="block";
			}
		}
		
	}
	
	function update()
	{
		if(gameStarted)
		{
			//if(testMode==false)
				drawSomething();
			
			if(devMode)
				displayStats();
			
			if(testMode)
			{
				//keep playing at rapid speed
				if((humanState!="play") && (activePlayers >1))
				{
					if((stuffAnalysed) && (totalGamesPlayed < 500))
						nextStageButton();
				}
				
				//but end the game if this isn't a full-blown AI test, and we are at the end
				else if((activePlayers==1) && (humanState !="auto"))
				{
					EndGame();
				}
			}
			
		}
		requestAnimationFrame(update);
	}
	
	window.addEventListener("load", function()
	{
		update();
	});
	
</script>

	<script src="AI.js"></script>

	<!--
	<audio id="cardPlace1" preload="auto">
        <source src="audio/cardPlace1.ogg" type="audio/ogg">
    </audio>
	
	<audio id="cardPlace2" preload="auto">
        <source src="audio/cardPlace2.ogg" type="audio/ogg">
    </audio>
	
	<audio id="cardPlace3" preload="auto">
        <source src="audio/cardPlace3.ogg" type="audio/ogg">
    </audio>
	
	<audio id="cardSlide1" preload="auto">
        <source src="audio/cardSlide1.ogg" type="audio/ogg">
    </audio>
	-->

</body>

</html>